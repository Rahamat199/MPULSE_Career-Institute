<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExamAce - NEET, JEE, IIT & KCET Test Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#1e40af',
                        accent: '#60a5fa',
                        dark: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            border: '#334155',
                            text: '#f1f5f9'
                        }
                    },
                    screens: {
                        'xs': '475px',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white min-h-screen text-black">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-2 border-gray-200">
        <div class="container mx-auto px-3 sm:px-6 py-3 sm:py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2 sm:space-x-3">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-lg">
                        <span class="text-white font-bold text-lg sm:text-xl">EA</span>
                    </div>
                    <h1 class="text-lg sm:text-2xl font-bold text-black">ExamAce</h1>
                </div>
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <span class="text-gray-700 text-sm sm:text-base hidden sm:inline" id="welcomeText">Welcome, Student!</span>
                    <button id="resetDataBtn" onclick="showResetModal()" class="px-2 py-1 sm:px-4 sm:py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg hover:from-yellow-600 hover:to-orange-600 font-medium text-xs sm:text-sm transition-all duration-300 transform hover:scale-105 shadow-lg hidden">
                        Reset
                    </button>
                    <button onclick="logout()" class="px-2 py-1 sm:px-4 sm:py-2 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-lg hover:from-red-600 hover:to-pink-600 font-medium text-xs sm:text-sm transition-all duration-300 transform hover:scale-105 shadow-lg">
                        Logout
                    </button>
                    <div id="profilePic" class="w-6 h-6 sm:w-8 sm:h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg">
                        <span class="text-white text-xs sm:text-sm font-semibold" id="profileInitials">S</span>
                    </div>
                    <span class="text-xs sm:text-sm text-gray-300 hidden sm:inline" id="userIdDisplay"></span>
                </div>
            </div>
        </div>
    </header>

    <div class="flex">
        <!-- Mobile Navigation -->
        <nav class="lg:hidden bg-gray-100 border-b border-gray-300 px-4 py-2 overflow-x-auto">
            <div class="flex space-x-2 min-w-max">
                <button onclick="showSection('dashboard')" class="nav-btn-mobile px-3 py-2 rounded-lg bg-blue-600 text-white font-medium flex items-center space-x-2 text-sm whitespace-nowrap">
                    <span>üìä</span>
                    <span>Dashboard</span>
                </button>
                <button onclick="showSection('tests')" class="nav-btn-mobile px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-200 font-medium flex items-center space-x-2 text-sm whitespace-nowrap">
                    <span>üìù</span>
                    <span>Tests</span>
                </button>
                <button onclick="showSection('results')" class="nav-btn-mobile px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-200 font-medium flex items-center space-x-2 text-sm whitespace-nowrap">
                    <span>üìà</span>
                    <span>Results</span>
                </button>
                <button onclick="showSection('pyq')" class="nav-btn-mobile px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-200 font-medium flex items-center space-x-2 text-sm whitespace-nowrap">
                    <span>üìö</span>
                    <span>PYQ</span>
                </button>
                <button onclick="showSection('pdfManager')" class="nav-btn-mobile px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-200 font-medium flex items-center space-x-2 text-sm whitespace-nowrap">
                    <span>üìã</span>
                    <span>PDFs</span>
                </button>
                <button id="userManagementNavMobile" onclick="showSection('userManagement')" class="nav-btn-mobile px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-200 font-medium flex items-center space-x-2 text-sm whitespace-nowrap hidden">
                    <span>üë•</span>
                    <span>Admin</span>
                </button>
            </div>
        </nav>

        <!-- Desktop Sidebar -->
        <aside class="hidden lg:block w-64 bg-gray-100 shadow-lg min-h-screen border-r border-gray-300">
            <nav class="p-6">
                <ul class="space-y-2">
                    <li>
                        <button onclick="showSection('dashboard')" class="nav-btn w-full text-left px-4 py-3 rounded-lg bg-blue-600 text-white font-medium flex items-center space-x-3 shadow-lg transition-all duration-300 transform hover:scale-105">
                            <span>üìä</span>
                            <span>Dashboard</span>
                        </button>
                    </li>
                    <li>
                        <button onclick="showSection('tests')" class="nav-btn w-full text-left px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-200 hover:text-gray-900 font-medium flex items-center space-x-3 transition-all duration-300 transform hover:scale-105">
                            <span>üìù</span>
                            <span>Test Exams</span>
                        </button>
                    </li>
                    <li>
                        <button onclick="showSection('results')" class="nav-btn w-full text-left px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-200 hover:text-gray-900 font-medium flex items-center space-x-3 transition-all duration-300 transform hover:scale-105">
                            <span>üìà</span>
                            <span>Results</span>
                        </button>
                    </li>
                    <li>
                        <button onclick="showSection('pyq')" class="nav-btn w-full text-left px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-200 hover:text-gray-900 font-medium flex items-center space-x-3 transition-all duration-300 transform hover:scale-105">
                            <span>üìö</span>
                            <span>Previous Year Questions</span>
                        </button>
                    </li>
                   
                    <li id="userManagementNav" class="hidden">
                        <button onclick="showSection('userManagement')" class="nav-btn w-full text-left px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-200 hover:text-gray-900 font-medium flex items-center space-x-3 transition-all duration-300 transform hover:scale-105">
                            <span>üë•</span>
                            <span>User Management</span>
                        </button>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-4 lg:p-8">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-black mb-2">Dashboard</h2>
                    <p class="text-gray-600">Track your progress across all competitive exams</p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8">
                    <div class="bg-white rounded-xl shadow-lg p-3 sm:p-4 lg:p-6 border-l-4 border-green-500 transition-all duration-300 hover:scale-105">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-xs sm:text-sm">Tests Completed</p>
                                <p class="text-lg sm:text-xl lg:text-2xl font-bold text-black" id="testsCompleted">0</p>
                            </div>
                            <div class="w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center shadow-lg">
                                <span class="text-white text-sm sm:text-lg lg:text-xl">‚úì</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-3 sm:p-4 lg:p-6 border-l-4 border-blue-500 transition-all duration-300 hover:scale-105">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-xs sm:text-sm">Average Accuracy</p>
                                <p class="text-lg sm:text-xl lg:text-2xl font-bold text-black" id="avgAccuracy">0%</p>
                            </div>
                            <div class="w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center shadow-lg">
                                <span class="text-white text-sm sm:text-lg lg:text-xl">üéØ</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-3 sm:p-4 lg:p-6 border-l-4 border-purple-500 transition-all duration-300 hover:scale-105">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-xs sm:text-sm">Best Score</p>
                                <p class="text-lg sm:text-xl lg:text-2xl font-bold text-black" id="bestScore">0%</p>
                            </div>
                            <div class="w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center shadow-lg">
                                <span class="text-white text-sm sm:text-lg lg:text-xl">üèÜ</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-3 sm:p-4 lg:p-6 border-l-4 border-orange-500 transition-all duration-300 hover:scale-105">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-xs sm:text-sm">Study Streak</p>
                                <p class="text-lg sm:text-xl lg:text-2xl font-bold text-black" id="studyStreak">1 day</p>
                            </div>
                            <div class="w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center shadow-lg">
                                <span class="text-white text-sm sm:text-lg lg:text-xl">üî•</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-black mb-4">Recent Test Activity</h3>
                    <div id="recentActivity" class="space-y-4">
                        <div class="text-center text-gray-400 py-8">
                            <p>No recent tests. Start taking tests to see your activity here!</p>
                        </div>
                    </div>
                </div>

                <!-- Chapter-wise Accuracy -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-black mb-4">üìä Chapter-wise Performance</h3>
                    <div id="chapterAccuracy" class="space-y-4">
                        <div class="text-center text-gray-400 py-8">
                            <p>No chapter data available. Complete tests to see your performance by chapter!</p>
                        </div>
                    </div>
                </div>

                <!-- Feedback Section -->
                <div class="bg-gradient-to-br from-blue-900 to-purple-900 rounded-xl shadow-2xl p-6 backdrop-blur-sm border border-blue-500/30">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                        <span class="mr-2">üí¨</span>
                        Share Your Feedback
                    </h3>
                    <p class="text-gray-300 mb-4">Help us improve ExamAce! Send your suggestions, bug reports, or feature requests.</p>
                    <div class="flex items-center space-x-4">
                        <div class="flex-1">
                            <p class="text-sm text-gray-400 mb-2">Email us at:</p>
                            <a href="mailto:mpulseinstitutions@gmail.com" class="text-blue-400 hover:text-blue-300 font-semibold transition-colors">
                                mpulseinstitutions@gmail.com
                            </a>
                        </div>
                        <button onclick="window.open('mailto:mpulseinstitutions@gmail.com?subject=ExamAce Feedback&body=Hi ExamAce Team,%0A%0AI would like to share the following feedback:%0A%0A', '_blank')" 
                                class="px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                            Send Feedback
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tests Section -->
            <div id="tests" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Test Exams</h2>
                    <p class="text-gray-600">Choose your exam, subject, and chapter</p>
                </div>

                <!-- Exam Selection -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <button onclick="selectExam('NEET')" class="exam-btn bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-primary">
                        <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-red-600 text-2xl font-bold">N</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">NEET</h3>
                        <p class="text-gray-600 text-sm">Medical Entrance</p>
                    </button>
                    <button onclick="selectExam('JEE')" class="exam-btn bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-primary">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-blue-600 text-2xl font-bold">J</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">JEE</h3>
                        <p class="text-gray-600 text-sm">Engineering Entrance</p>
                    </button>
                    <button onclick="selectExam('IIT')" class="exam-btn bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-primary">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-green-600 text-2xl font-bold">I</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">IIT</h3>
                        <p class="text-gray-600 text-sm">Advanced Level</p>
                    </button>
                    <button onclick="selectExam('KCET')" class="exam-btn bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-primary">
                        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-purple-600 text-2xl font-bold">K</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">KCET</h3>
                        <p class="text-gray-600 text-sm">Karnataka CET</p>
                    </button>
                </div>

                <!-- Subject and Chapter Selection -->
                <div id="subjectSelection" class="bg-white rounded-xl shadow-lg p-6 mb-6 hidden">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Select Subject & Chapter</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Physics -->
                        <div class="border rounded-lg p-4">
                            <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                                <span class="w-6 h-6 bg-red-100 rounded mr-2 flex items-center justify-center">
                                    <span class="text-red-600 text-sm">‚ö°</span>
                                </span>
                                Physics
                            </h4>
                            <div class="space-y-2">
                                 <button onclick="selectChapter('Physics', 'Physical World')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: Physical World</button>
    <button onclick="selectChapter('Physics', 'Units and Measurements')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 2: Units and Measurements</button>
    <button onclick="selectChapter('Physics', 'Motion in a Straight Line')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 3 :Motion in a Straight Line</button>
    <button onclick="selectChapter('Physics', 'Motion in a Plane')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Motion in a Plane</button>
    <button onclick="selectChapter('Physics', 'Laws of Motion')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Laws of Motion</button>
    <button onclick="selectChapter('Physics', 'Work, Energy and Power')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Work, Energy and Power</button>
    <button onclick="selectChapter('Physics', 'System of Particles and Rotational Motion')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">System of Particles and Rotational Motion</button>
    <button onclick="selectChapter('Physics', 'Gravitation')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Gravitation</button>
    <button onclick="selectChapter('Physics', 'Mechanical Properties of Solids')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Mechanical Properties of Solids</button>
    <button onclick="selectChapter('Physics', 'Mechanical Properties of Fluids')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Mechanical Properties of Fluids</button>
    <button onclick="selectChapter('Physics', 'Thermal Properties of Matter')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Thermal Properties of Matter</button>
    <button onclick="selectChapter('Physics', 'Thermodynamics')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Thermodynamics</button>
    <button onclick="selectChapter('Physics', 'Kinetic Theory')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Kinetic Theory</button>
    <button onclick="selectChapter('Physics', 'Oscillations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Oscillations</button>
    <button onclick="selectChapter('Physics', 'Waves')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Waves</button>
    <button onclick="selectChapter('Physics', 'Electric Charges and Fields')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: Electric Charges and Fields</button>
    <button onclick="selectChapter('Physics', 'Electrostatic Potential and Capacitance')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Electrostatic Potential and Capacitance</button>
    <button onclick="selectChapter('Physics', 'Current Electricity')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Current Electricity</button>
    <button onclick="selectChapter('Physics', 'Moving Charges and Magnetism')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Moving Charges and Magnetism</button>
    <button onclick="selectChapter('Physics', 'Magnetism and Matter')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Magnetism and Matter</button>
    <button onclick="selectChapter('Physics', 'Electromagnetic Induction')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Electromagnetic Induction</button>
    <button onclick="selectChapter('Physics', 'Alternating Current')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Alternating Current</button>
    <button onclick="selectChapter('Physics', 'Electromagnetic Waves')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Electromagnetic Waves</button>
    <button onclick="selectChapter('Physics', 'Ray Optics and Optical Instruments')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Ray Optics and Optical Instruments</button>
    <button onclick="selectChapter('Physics', 'Wave Optics')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Wave Optics</button>
    <button onclick="selectChapter('Physics', 'Dual Nature of Radiation and Matter')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Dual Nature of Radiation and Matter</button>
    <button onclick="selectChapter('Physics', 'Atoms')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Atoms</button>
    <button onclick="selectChapter('Physics', 'Nuclei')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Nuclei</button>
    <button onclick="selectChapter('Physics', 'Semiconductor Electronics')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Semiconductor Electronics</button>
  </div>
                        </div>
                        <!-- Chemistry -->
                        <div class="border rounded-lg p-4">
                            <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                                <span class="w-6 h-6 bg-blue-100 rounded mr-2 flex items-center justify-center">
                                    <span class="text-blue-600 text-sm">üß™</span>
                                </span>
                                Chemistry
                            </h4>
                            <div class="space-y-2">
                               <!-- Class 11 Chemistry -->
    <button onclick="selectChapter('Chemistry', 'Some Basic Concepts of Chemistry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: Some Basic Concepts of Chemistry</button>
    <button onclick="selectChapter('Chemistry', 'Structure of Atom')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Structure of Atom</button>
    <button onclick="selectChapter('Chemistry', 'Classification of Elements and Periodicity in Properties')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Classification of Elements and Periodicity in Properties</button>
    <button onclick="selectChapter('Chemistry', 'Chemical Bonding and Molecular Structure')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chemical Bonding and Molecular Structure</button>
    <button onclick="selectChapter('Chemistry', 'States of Matter: Gases and Liquids')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">States of Matter: Gases and Liquids</button>
    <button onclick="selectChapter('Chemistry', 'Thermodynamics')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Thermodynamics</button>
    <button onclick="selectChapter('Chemistry', 'Equilibrium')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Equilibrium</button>
    <button onclick="selectChapter('Chemistry', 'Redox Reactions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Redox Reactions</button>
    <button onclick="selectChapter('Chemistry', 'Hydrogen')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Hydrogen</button>
    <button onclick="selectChapter('Chemistry', 'The s-Block Element')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">The s-Block Element</button>
    <button onclick="selectChapter('Chemistry', 'Some p-Block Elements')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Some p-Block Elements</button>
    <button onclick="selectChapter('Chemistry', 'Organic Chemistry - Some Basic Principles and Techniques')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Organic Chemistry - Some Basic Principles and Techniques</button>
    <button onclick="selectChapter('Chemistry', 'Hydrocarbons')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Hydrocarbons</button>
    <button onclick="selectChapter('Chemistry', 'Environmental Chemistry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Environmental Chemistry</button>

    <!-- Class 12 Chemistry -->
    <button onclick="selectChapter('Chemistry', 'The Solid State')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: The Solid State</button>
    <button onclick="selectChapter('Chemistry', 'Solutions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Solutions</button>
    <button onclick="selectChapter('Chemistry', 'Electrochemistry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Electrochemistry</button>
    <button onclick="selectChapter('Chemistry', 'Chemical Kinetics')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chemical Kinetics</button>
    <button onclick="selectChapter('Chemistry', 'Surface Chemistry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Surface Chemistry</button>
    <button onclick="selectChapter('Chemistry', 'The p-Block Element')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">The p-Block Element</button>
    <button onclick="selectChapter('Chemistry', 'The d- and f-Block Elements')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">The d- and f-Block Elements</button>
    <button onclick="selectChapter('Chemistry', 'Coordination Compounds')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Coordination Compounds</button>
    <button onclick="selectChapter('Chemistry', 'Haloalkanes and Haloarenes')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Haloalkanes and Haloarenes</button>
    <button onclick="selectChapter('Chemistry', 'Alcohols, Phenols and Ethers')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Alcohols, Phenols and Ethers</button>
    <button onclick="selectChapter('Chemistry', 'Aldehydes, Ketones and Carboxylic Acids')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Aldehydes, Ketones and Carboxylic Acids</button>
    <button onclick="selectChapter('Chemistry', 'Organic Compounds Containing Nitrogen')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Organic Compounds Containing Nitrogen</button>
    <button onclick="selectChapter('Chemistry', 'Biomolecules')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Biomolecules</button>
    <button onclick="selectChapter('Chemistry', 'Polymers')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Polymers</button>
    <button onclick="selectChapter('Chemistry', 'Chemistry in Everyday Life')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chemistry in Everyday Life</button>
</div>
                        </div>
                        <!-- Mathematics/Biology -->
                        <div class="border rounded-lg p-4">
                            <h4 class="font-bold text-gray-800 mb-3 flex items-center" id="thirdSubjectTitle">
                                <span class="w-6 h-6 bg-green-100 rounded mr-2 flex items-center justify-center">
                                    <span class="text-green-600 text-sm">üìê</span>
                                </span>
                                Mathematics
                            </h4>
                            <div class="space-y-2" id="thirdSubjectChapters">
                                <!-- Class 11 Mathematics -->
    <button onclick="selectChapter('Mathematics', 'Sets')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Sets</button>
    <button onclick="selectChapter('Mathematics', 'Relations and Functions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Relations and Functions</button>
    <button onclick="selectChapter('Mathematics', 'Trigonometric Functions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Trigonometric Functions</button>
    <button onclick="selectChapter('Mathematics', 'Principle of Mathematical Induction')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Principle of Mathematical Induction</button>
    <button onclick="selectChapter('Mathematics', 'Complex Numbers and Quadratic Equations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Complex Numbers and Quadratic Equations</button>
    <button onclick="selectChapter('Mathematics', 'Linear Inequalities')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Linear Inequalities</button>
    <button onclick="selectChapter('Mathematics', 'Permutations and Combinations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Permutations and Combinations</button>
    <button onclick="selectChapter('Mathematics', 'Binomial Theorem')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Binomial Theorem</button>
    <button onclick="selectChapter('Mathematics', 'Sequences and Series')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Sequences and Series</button>
    <button onclick="selectChapter('Mathematics', 'Straight Lines')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Straight Lines</button>
    <button onclick="selectChapter('Mathematics', 'Conic Sections')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Conic Sections</button>
    <button onclick="selectChapter('Mathematics', 'Introduction to Three Dimensional Geometry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Introduction to Three Dimensional Geometry</button>
    <button onclick="selectChapter('Mathematics', 'Limits and Derivatives')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Limits and Derivatives</button>
    <button onclick="selectChapter('Mathematics', 'Mathematical Reasoning')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Mathematical Reasoning</button>
    <button onclick="selectChapter('Mathematics', 'Statistics')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Statistics</button>
    <button onclick="selectChapter('Mathematics', 'Probability')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Probability</button>

    <!-- Class 12 Mathematics -->
    <button onclick="selectChapter('Mathematics', 'Relations and Functions (Class 12)')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Relations and Functions (Class 12)</button>
    <button onclick="selectChapter('Mathematics', 'Inverse Trigonometric Functions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Inverse Trigonometric Functions</button>
    <button onclick="selectChapter('Mathematics', 'Matrices')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Matrices</button>
    <button onclick="selectChapter('Mathematics', 'Determinants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Determinants</button>
    <button onclick="selectChapter('Mathematics', 'Continuity and Differentiability')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Continuity and Differentiability</button>
    <button onclick="selectChapter('Mathematics', 'Application of Derivatives')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Application of Derivatives</button>
    <button onclick="selectChapter('Mathematics', 'Integrals')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Integrals</button>
    <button onclick="selectChapter('Mathematics', 'Application of Integrals')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Application of Integrals</button>
    <button onclick="selectChapter('Mathematics', 'Differential Equations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Differential Equations</button>
    <button onclick="selectChapter('Mathematics', 'Vector Algebra')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Vector Algebra</button>
    <button onclick="selectChapter('Mathematics', 'Three Dimensional Geometry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Three Dimensional Geometry</button>
    <button onclick="selectChapter('Mathematics', 'Linear Programming')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Linear Programming</button>
    <button onclick="selectChapter('Mathematics', 'Probability (Class 12)')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Probability (Class 12)</button>
 </div>
                        </div>
                    </div>
                </div>

                <!-- Start Test Button -->
                <div id="startTestSection" class="bg-white rounded-xl shadow-lg p-6 hidden">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Ready to Start Test?</h3>
                    <div class="mb-6">
                        <p class="text-gray-600 mb-4" id="testDetails">Selected: NEET > Physics > Some Basic Concepts of Chemistry</p>
                        
                        <!-- Question Count Selection -->
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Number of Questions:</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center">
                                    <input type="radio" name="questionCount" value="10" class="text-primary mr-2">
                                    <span>10 Questions (20 minutes)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="questionCount" value="20" checked class="text-primary mr-2">
                                    <span>20 Questions (40 minutes)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="questionCount" value="50" class="text-primary mr-2">
                                    <span>50 Questions (100 minutes)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="questionCount" value="100" class="text-primary mr-2">
                                    <span>100 Questions (200 minutes)</span>
                                </label>
                            </div>
                        </div>
                        

                    </div>
                    
                    <div class="flex justify-end">
                        <button onclick="startTest()" class="px-8 py-3 bg-primary text-white rounded-lg hover:bg-secondary font-semibold">Start Test</button>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Test Results</h2>
                    <p class="text-gray-600">View your performance and track progress</p>
                </div>

                <!-- Filter Buttons -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">üìä Filter Results</h3>
                    
                    <!-- Subject-wise Filters -->
                    <div class="mb-4">
                        <h4 class="text-sm font-semibold text-gray-700 mb-2">Subject-wise:</h4>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="filterResults('subject', 'all')" class="filter-btn px-4 py-2 rounded-lg bg-blue-600 text-white text-sm font-medium hover:bg-blue-700 transition-colors">
                                All Subjects
                            </button>
                            <button onclick="filterResults('subject', 'Physics')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                ‚ö° Physics
                            </button>
                            <button onclick="filterResults('subject', 'Chemistry')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                üß™ Chemistry
                            </button>
                            <button onclick="filterResults('subject', 'Mathematics')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                üìê Mathematics
                            </button>
                            <button onclick="filterResults('subject', 'Biology')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                üß¨ Biology
                            </button>
                        </div>
                    </div>

                    <!-- PYQ Filters -->
                    <div class="mb-4">
                        <h4 class="text-sm font-semibold text-gray-700 mb-2">Previous Year Questions (PYQ):</h4>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="filterResults('exam', 'NEET')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                ü©∫ NEET PYQ
                            </button>
                            <button onclick="filterResults('exam', 'IIT')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                üéì IIT PYQ
                            </button>
                            <button onclick="filterResults('exam', 'JEE')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                ‚öôÔ∏è JEE PYQ
                            </button>
                            <button onclick="filterResults('exam', 'KCET')" class="filter-btn px-4 py-2 rounded-lg bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors">
                                üèõÔ∏è KCET PYQ
                            </button>
                        </div>
                    </div>

                    <!-- Clear Filters -->
                    <div class="flex justify-end">
                        <button onclick="clearAllFilters()" class="px-4 py-2 bg-red-500 text-white text-sm font-medium rounded-lg hover:bg-red-600 transition-colors">
                            Clear All Filters
                        </button>
                    </div>
                </div>

                <!-- Test History -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">Test History</h3>
                        <div class="text-sm text-gray-600" id="historyInfo">
                            Showing 0 of 0 tests
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Test Details</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Date & Time</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Total Marks</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Accuracy</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Attempted</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Correct</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Wrong</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Status</th>
                                </tr>
                            </thead>
                            <tbody id="testHistoryTable">
                                <tr>
                                    <td colspan="8" class="text-center py-8 text-gray-500">
                                        No tests completed yet. Start taking tests to see your history!
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination Controls -->
                    <div id="paginationControls" class="flex justify-between items-center mt-6 hidden">
                        <div class="flex items-center space-x-2">
                            <button id="prevPageBtn" onclick="changePage(-1)" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-semibold disabled:opacity-50 disabled:cursor-not-allowed">
                                Previous
                            </button>
                            <span id="pageInfo" class="text-sm text-gray-600">Page 1 of 1</span>
                            <button id="nextPageBtn" onclick="changePage(1)" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold disabled:opacity-50 disabled:cursor-not-allowed">
                                Next
                            </button>
                        </div>
                        <div class="text-sm text-gray-600">
                            <span id="testsPerPageInfo">10 tests per page</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PDF Manager Section -->
            <div id="pdfManager" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">PDF Manager</h2>
                    <p class="text-gray-600">Manage and download your exam PDFs by category</p>
                </div>

                <!-- Exam Selection for PDFs -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- NEET PDF Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-red-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">ü©∫</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">NEET PDFs</h3>
                        <p class="text-gray-600 text-sm mb-3">Medical Entrance Papers</p>
                        <div class="bg-red-50 rounded-lg p-3 mb-4">
                            <p class="text-red-800 font-semibold text-sm" id="neetPdfCount">Loading...</p>
                            <p class="text-red-600 text-xs">Physics, Chemistry, Biology</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="showExamPDFs('NEET')" class="w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold text-sm transition-all duration-300">
                                üìã View NEET PDFs
                            </button>
                        </div>
                    </div>

                    <!-- JEE PDF Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-blue-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">‚öôÔ∏è</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">JEE PDFs</h3>
                        <p class="text-gray-600 text-sm mb-3">Engineering Entrance Papers</p>
                        <div class="bg-blue-50 rounded-lg p-3 mb-4">
                            <p class="text-blue-800 font-semibold text-sm" id="jeePdfCount">Loading...</p>
                            <p class="text-blue-600 text-xs">Physics, Chemistry, Mathematics</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="showExamPDFs('JEE')" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold text-sm transition-all duration-300">
                                üìã View JEE PDFs
                            </button>
                        </div>
                    </div>

                    <!-- IIT PDF Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-green-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">üéì</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">IIT PDFs</h3>
                        <p class="text-gray-600 text-sm mb-3">Advanced Level Papers</p>
                        <div class="bg-green-50 rounded-lg p-3 mb-4">
                            <p class="text-green-800 font-semibold text-sm" id="iitPdfCount">Loading...</p>
                            <p class="text-green-600 text-xs">Physics, Chemistry, Mathematics</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="showExamPDFs('IIT')" class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-sm transition-all duration-300">
                                üìã View IIT PDFs
                            </button>
                        </div>
                    </div>

                    <!-- KCET PDF Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-purple-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-violet-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">üèõÔ∏è</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">KCET PDFs</h3>
                        <p class="text-gray-600 text-sm mb-3">Karnataka CET Papers</p>
                        <div class="bg-purple-50 rounded-lg p-3 mb-4">
                            <p class="text-purple-800 font-semibold text-sm" id="kcetPdfCount">Loading...</p>
                            <p class="text-purple-600 text-xs">Physics, Chemistry, Mathematics</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="showExamPDFs('KCET')" class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-semibold text-sm transition-all duration-300">
                                üìã View KCET PDFs
                            </button>
                        </div>
                    </div>
                </div>

                <!-- PDF Information -->
                <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="mr-2">üìã</span>
                        PDF Manager Features
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div class="flex items-start space-x-3">
                                <span class="text-blue-600 text-xl">üìÑ</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Download Management</h4>
                                    <p class="text-sm text-gray-600">Track your PDF downloads and avoid duplicates</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="text-green-600 text-xl">üìä</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Progress Tracking</h4>
                                    <p class="text-sm text-gray-600">Monitor your study progress across all exams</p>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div class="flex items-start space-x-3">
                                <span class="text-purple-600 text-xl">üéØ</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Exam-Specific Content</h4>
                                    <p class="text-sm text-gray-600">Organized by exam type for focused preparation</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="text-orange-600 text-xl">üîÑ</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Reset Options</h4>
                                    <p class="text-sm text-gray-600">Clear download history when needed</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Previous Year Questions Section -->
            <div id="pyq" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Previous Year Questions (PYQ)</h2>
                    <p class="text-gray-600">Access comprehensive PYQ papers for all competitive exams</p>
                </div>

                <!-- Individual Exam PYQ Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- NEET PYQ Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-red-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">ü©∫</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">NEET PYQ</h3>
                        <p class="text-gray-600 text-sm mb-3">Medical Entrance</p>
                        <div class="bg-red-50 rounded-lg p-3 mb-4">
                            <p class="text-red-800 font-semibold text-sm">${pyqQuestionBank.NEET ? pyqQuestionBank.NEET.length : 0} Questions Available</p>
                            <p class="text-red-600 text-xs">Physics, Chemistry, Biology</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="startPYQTest('NEET')" class="w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold text-sm transition-all duration-300">
                                üìù Take Test
                            </button>
                            <button onclick="downloadExamPYQ('NEET')" class="w-full px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 font-semibold text-sm transition-all duration-300">
                                üìÑ Download PDF
                            </button>
                        </div>
                    </div>

                    <!-- JEE PYQ Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-blue-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">‚öôÔ∏è</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">JEE PYQ</h3>
                        <p class="text-gray-600 text-sm mb-3">Engineering Entrance</p>
                        <div class="bg-blue-50 rounded-lg p-3 mb-4">
                            <p class="text-blue-800 font-semibold text-sm">${pyqQuestionBank.JEE ? pyqQuestionBank.JEE.length : 0} Questions Available</p>
                            <p class="text-blue-600 text-xs">Physics, Chemistry, Mathematics</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="startPYQTest('JEE')" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold text-sm transition-all duration-300">
                                üìù Take Test
                            </button>
                            <button onclick="downloadExamPYQ('JEE')" class="w-full px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 font-semibold text-sm transition-all duration-300">
                                üìÑ Download PDF
                            </button>
                        </div>
                    </div>

                    <!-- IIT PYQ Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-green-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">üéì</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">IIT PYQ</h3>
                        <p class="text-gray-600 text-sm mb-3">Advanced Level</p>
                        <div class="bg-green-50 rounded-lg p-3 mb-4">
                            <p class="text-green-800 font-semibold text-sm">${pyqQuestionBank.IIT ? pyqQuestionBank.IIT.length : 0} Questions Available</p>
                            <p class="text-green-600 text-xs">Physics, Chemistry, Mathematics</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="startPYQTest('IIT')" class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-sm transition-all duration-300">
                                üìù Take Test
                            </button>
                            <button onclick="downloadExamPYQ('IIT')" class="w-full px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 font-semibold text-sm transition-all duration-300">
                                üìÑ Download PDF
                            </button>
                        </div>
                    </div>

                    <!-- KCET PYQ Card -->
                    <div class="bg-white rounded-xl shadow-lg p-6 text-center hover:shadow-xl transition-all duration-300 border-2 border-transparent hover:border-purple-500">
                        <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-violet-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-2xl">üèõÔ∏è</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">KCET PYQ</h3>
                        <p class="text-gray-600 text-sm mb-3">Karnataka CET</p>
                        <div class="bg-purple-50 rounded-lg p-3 mb-4">
                            <p class="text-purple-800 font-semibold text-sm">${pyqQuestionBank.KCET ? pyqQuestionBank.KCET.length : 0} Questions Available</p>
                            <p class="text-purple-600 text-xs">Physics, Chemistry, Mathematics</p>
                        </div>
                        <div class="space-y-2">
                            <button onclick="startPYQTest('KCET')" class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-semibold text-sm transition-all duration-300">
                                üìù Take Test
                            </button>
                            <button onclick="downloadExamPYQ('KCET')" class="w-full px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 font-semibold text-sm transition-all duration-300">
                                üìÑ Download PDF
                            </button>
                        </div>
                    </div>
                </div>



                <!-- PYQ Information -->
                <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <span class="mr-2">üìã</span>
                        What's Included in PYQ Paper
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div class="flex items-start space-x-3">
                                <span class="text-red-600 text-xl">ü©∫</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">NEET Questions</h4>
                                    <p class="text-sm text-gray-600">Physics, Chemistry & Biology questions from recent years</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="text-blue-600 text-xl">‚öôÔ∏è</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">JEE Questions</h4>
                                    <p class="text-sm text-gray-600">Physics, Chemistry & Mathematics for JEE Main</p>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div class="flex items-start space-x-3">
                                <span class="text-green-600 text-xl">üéì</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">IIT Advanced</h4>
                                    <p class="text-sm text-gray-600">Advanced level questions with detailed solutions</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <span class="text-purple-600 text-xl">üèõÔ∏è</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">KCET Questions</h4>
                                    <p class="text-sm text-gray-600">Karnataka CET previous year papers</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-white rounded-lg border border-blue-200">
                        <h4 class="font-semibold text-gray-800 mb-2">üìù Paper Features:</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>‚Ä¢ Complete solutions with step-by-step explanations</li>
                            <li>‚Ä¢ Year-wise organization for easy reference</li>
                            <li>‚Ä¢ Subject and chapter-wise categorization</li>
                            <li>‚Ä¢ Professional formatting for easy printing</li>
                            <li>‚Ä¢ Updated with latest exam patterns</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- User Management Section -->
            <div id="userManagement" class="section hidden">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">User Management</h2>
                    <p class="text-gray-600">Manage user accounts and system data</p>
                </div>

                <!-- Current User Info -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Current User Profile</h3>
                    <div class="flex items-center space-x-4">
                        <div id="currentUserPic" class="w-16 h-16 bg-primary rounded-full flex items-center justify-center">
                            <span class="text-white text-xl font-bold" id="currentUserInitials">S</span>
                        </div>
                        <div>
                            <h4 class="text-lg font-semibold text-gray-800" id="currentUserName">Student</h4>
                            <p class="text-gray-600" id="currentUserId">Not logged in</p>
                            <p class="text-sm text-gray-500" id="currentUserStats">No data available</p>
                        </div>
                    </div>
                </div>

                <!-- All Users List -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">All User Accounts</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="allUsersList">
                        <!-- Users will be populated here -->
                    </div>
                </div>

                <!-- Add New User -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Add New User Account</h3>
                    <form onsubmit="addNewUser(event)" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Student ID</label>
                            <input type="text" id="newUserId" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" placeholder="e.g., student011">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                            <input type="text" id="newUserPassword" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" placeholder="e.g., password123">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Full Name</label>
                            <input type="text" id="newUserName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" placeholder="e.g., John Doe">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Profile Color</label>
                            <select id="newUserColor" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                                <option value="bg-red-500">Red</option>
                                <option value="bg-blue-500">Blue</option>
                                <option value="bg-green-500">Green</option>
                                <option value="bg-purple-500">Purple</option>
                                <option value="bg-pink-500">Pink</option>
                                <option value="bg-orange-500">Orange</option>
                                <option value="bg-indigo-500">Indigo</option>
                                <option value="bg-teal-500">Teal</option>
                                <option value="bg-rose-500">Rose</option>
                                <option value="bg-cyan-500">Cyan</option>
                                <option value="bg-lime-500">Lime</option>
                                <option value="bg-amber-500">Amber</option>
                                <option value="bg-emerald-500">Emerald</option>
                                <option value="bg-violet-500">Violet</option>
                                <option value="bg-yellow-500">Yellow</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold">
                                Add New User
                            </button>
                        </div>
                    </form>
                </div>

                <!-- System Actions -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">System Actions</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button onclick="showResetModal()" class="px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold flex items-center justify-center space-x-2">
                            <span>üóëÔ∏è</span>
                            <span>Reset Current User Data</span>
                        </button>
                        <button onclick="showResetAllModal()" class="px-6 py-3 bg-red-800 text-white rounded-lg hover:bg-red-900 font-semibold flex items-center justify-center space-x-2">
                            <span>‚ö†Ô∏è</span>
                            <span>Reset All Users Data</span>
                        </button>
                        <button onclick="exportUserData()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold flex items-center justify-center space-x-2">
                            <span>üìä</span>
                            <span>Export User Data</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Test Interface (Hidden by default) -->
            <div id="testInterface" class="section hidden">
                <div class="flex flex-col lg:grid lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6">
                    <!-- Question Navigator Sidebar - Shows on desktop -->
                    <div class="order-2 lg:order-1 lg:col-span-1">
                        <div class="bg-white rounded-xl shadow-lg p-3 sm:p-4 lg:p-6">
                            <h4 class="font-bold text-gray-800 mb-3 sm:mb-4 text-center text-sm sm:text-base">Question Navigator</h4>
                            <div class="grid grid-cols-6 sm:grid-cols-8 lg:grid-cols-4 gap-1 sm:gap-2" id="questionNavigator">
                                <!-- Question numbers will be populated here -->
                            </div>
                            
                            <!-- Legend -->
                            <div class="mt-4 sm:mt-6 space-y-1 sm:space-y-2 text-xs">
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 sm:w-4 sm:h-4 bg-blue-500 rounded"></div>
                                    <span>Current</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 sm:w-4 sm:h-4 bg-green-500 rounded"></div>
                                    <span>Answered</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 sm:w-4 sm:h-4 bg-yellow-500 rounded"></div>
                                    <span>Marked</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 sm:w-4 sm:h-4 bg-gray-300 rounded"></div>
                                    <span>Not Visited</span>
                                </div>
                            </div>
                            
                            <!-- Submit Test Button -->
                            <button onclick="submitTest('Manual submission')" class="w-full mt-4 sm:mt-6 px-3 sm:px-4 py-2 sm:py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold text-xs sm:text-sm lg:text-base">
                                Submit Test
                            </button>
                        </div>
                    </div>

                    <!-- Main Question Area - Shows first on mobile -->
                    <div class="order-1 lg:order-2 lg:col-span-3">
                        <div class="bg-white rounded-xl shadow-lg p-3 sm:p-4 lg:p-6">
                            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 gap-2 sm:gap-0">
                                <div>
                                    <h3 class="text-lg sm:text-xl font-bold text-gray-800" id="testTitle">Test</h3>
                                    <p class="text-sm sm:text-base text-gray-600" id="testInfo">1 Question ‚Ä¢ 2 Minutes</p>
                                </div>
                                <div class="text-left sm:text-right">
                                    <p class="text-xs sm:text-sm text-gray-600">Time Remaining</p>
                                    <p class="text-xl sm:text-2xl font-bold text-red-600" id="timer">02:00</p>
                                </div>
                            </div>
                            
                            <div class="border-t pt-4 sm:pt-6">
                                <div class="mb-4 sm:mb-6">
                                    <p class="text-base sm:text-lg font-semibold text-gray-800 mb-3 sm:mb-4" id="questionNumber">Question 1 of 1</p>
                                    <p class="text-sm sm:text-base text-gray-700 mb-4 sm:mb-6 leading-relaxed" id="questionText">Loading question...</p>
                                    
                                    <div class="space-y-2 sm:space-y-3" id="optionsContainer">
                                        <!-- Options will be loaded dynamically -->
                                    </div>
                                </div>
                                
                                <!-- Navigation Buttons -->
                                <div class="flex flex-col gap-3">
                                    <div class="flex flex-wrap gap-2 justify-center sm:justify-start">
                                        <button id="prevBtn" onclick="previousQuestion()" class="px-3 sm:px-4 lg:px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-semibold disabled:opacity-50 disabled:cursor-not-allowed text-xs sm:text-sm lg:text-base">
                                            Previous
                                        </button>
                                        <button id="markBtn" onclick="markForReview()" class="px-3 sm:px-4 lg:px-6 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 font-semibold text-xs sm:text-sm lg:text-base">
                                            Mark
                                        </button>
                                        <button id="clearBtn" onclick="clearAnswer()" class="px-3 sm:px-4 lg:px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 font-semibold text-xs sm:text-sm lg:text-base">
                                            Clear
                                        </button>
                                        <button id="nextBtn" onclick="nextQuestion()" class="px-3 sm:px-4 lg:px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold text-xs sm:text-sm lg:text-base">
                                            Next
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="fixed inset-0 bg-gradient-to-br from-blue-600 to-purple-700 flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-white font-bold text-2xl">EA</span>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Welcome to ExamAce</h2>
                <p class="text-gray-600">Please login to continue</p>
            </div>
            
            <form onsubmit="login(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Student ID</label>
                    <input type="text" id="studentId" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Enter your Student ID">
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                    <input type="password" id="password" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Enter your Password">
                </div>
                
                <button type="submit" class="w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-secondary transition-colors">
                    Login
                </button>
            </form>
            
            <div class="mt-6 space-y-4">
                <!-- Help Section -->
                <div class="p-4 bg-blue-50 rounded-lg">
                    <p class="text-sm text-blue-800 font-semibold mb-3">üìö Need Help Logging In?</p>
                    <div class="text-xs text-blue-700 space-y-2">
                        <p>‚Ä¢ <strong>Students:</strong> Contact your instructor for login credentials</p>
                        <p>‚Ä¢ <strong>New Users:</strong> Ask an administrator to create your account</p>
                        <p>‚Ä¢ <strong>Administrators:</strong> Use your management credentials</p>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="p-4 bg-green-50 rounded-lg">
                    <p class="text-sm text-green-800 font-semibold mb-3">üìû Support Contact</p>
                    <div class="text-xs text-green-700 space-y-1">
                        <p>Email: <strong>mpulseinstitutions@gmail.com</strong></p>
                        <p>For login issues, account creation, or technical support</p>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Reset All Users Confirmation Modal -->
    <div id="resetAllModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-red-600 text-2xl">üö®</span>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Reset ALL Users Data</h2>
                <p class="text-gray-600">This will delete EVERYTHING for ALL users!</p>
            </div>
            
            <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                <p class="text-sm text-red-800 mb-2"><strong>‚ö†Ô∏è DANGER ZONE - This will permanently delete:</strong></p>
                <ul class="text-sm text-red-700 space-y-1">
                    <li>‚Ä¢ All user test history and results</li>
                    <li>‚Ä¢ All dashboard statistics for every user</li>
                    <li>‚Ä¢ All performance data across all accounts</li>
                    <li>‚Ä¢ All study progress for every student</li>
                    <li>‚Ä¢ This affects ALL ${Object.keys(userAccounts).length} user accounts</li>
                </ul>
            </div>
            
            <div class="flex space-x-4">
                <button onclick="closeResetAllModal()" class="flex-1 px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-semibold">
                    Cancel
                </button>
                <button onclick="confirmResetAll()" class="flex-1 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold">
                    Yes, Reset ALL
                </button>
            </div>
        </div>
    </div>

    <!-- PDF History Modal -->
    <div id="pdfHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">üìã PDF Download History</h2>
                <p class="text-gray-600">Track your downloaded PYQ papers by category</p>
            </div>
            
            <div id="pdfHistoryContent" class="space-y-6">
                <!-- PDF history will be populated here -->
            </div>
            
            <div class="text-center mt-8">
                <button onclick="closePDFHistoryModal()" class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">
                    Close
                </button>
                <button onclick="resetPDFHistory()" class="px-8 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold ml-4">
                    Reset History
                </button>
            </div>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="resetModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-red-600 text-2xl">‚ö†Ô∏è</span>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Reset All Data</h2>
                <p class="text-gray-600">This action cannot be undone!</p>
            </div>
            
            <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                <p class="text-sm text-red-800 mb-2"><strong>This will permanently delete:</strong></p>
                <ul class="text-sm text-red-700 space-y-1">
                    <li>‚Ä¢ All test history and results</li>
                    <li>‚Ä¢ Dashboard statistics</li>
                    <li>‚Ä¢ Performance data</li>
                    <li>‚Ä¢ Study progress</li>
                </ul>
            </div>
            
            <div class="flex space-x-4">
                <button onclick="closeResetModal()" class="flex-1 px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-semibold">
                    Cancel
                </button>
                <button onclick="confirmReset()" class="flex-1 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold">
                    Yes, Reset All
                </button>
            </div>
        </div>
    </div>

    <!-- Result Modal -->
    <div id="resultModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Test Results</h2>
                <p class="text-gray-600">Here's how you performed</p>
            </div>
            
            <!-- Result Statistics -->
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8" id="resultStats">
                <!-- Stats will be populated dynamically -->
            </div>
            

            
            <div class="text-center space-x-4">
                <button onclick="downloadAnalysisPDF()" class="px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold">
                    üìÑ Download Analysis PDF
                </button>
                <button onclick="closeResultModal()" class="px-8 py-3 bg-primary text-white rounded-lg hover:bg-secondary font-semibold">Continue</button>
            </div>
        </div>
    </div>

    <script>
        let selectedExam = '';
        let selectedSubject = '';
        let selectedChapter = '';
        let testTimer;
        let userAnswer = '';
        let currentQuestion = {};
        let testHistory = [];
        let totalTests = 0;
        let totalScore = 0;
        let bestScore = 0;
        let currentUser = '';
        let userManagementAccess = false; // Track if user has management access
        
        // New Scoring System Constants
        const POSITIVE_MARKS = 4; // +4 for correct answer
        const NEGATIVE_MARKS = -1; // -1 for wrong answer
        const UNATTEMPTED_MARKS = 0; // 0 for unattempted
        
        // Filter variables
        let activeFilters = {
            subject: 'all',
            exam: 'all'
        };
        
        // Test variables
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let questionCount = 20;
        let testStartTime = 0;
        let markedQuestions = [];
        let questionStatus = []; // 'not-visited', 'answered', 'marked', 'current'
        
        // PYQ variables
        let selectedPYQExam = '';
        let isPYQTest = false;
        
        // PDF tracking variables
        let downloadedQuestions = {}; // Track downloaded questions per exam
        let availablePDFs = {}; // Track available PDFs per exam
        
        // Security variables
        let tabSwitchWarnings = 0;
        let isTestActive = false;
        let wrongAnsweredQuestions = [];
        
        // Pagination variables
        let currentPage = 1;
        let testsPerPage = 10;
        
        // Dark mode variable
        let isDarkMode = true; // Default to dark mode

        // Filter Functions
        function filterResults(filterType, filterValue) {
            activeFilters[filterType] = filterValue;
            currentPage = 1; // Reset to first page when filtering
            
            // Update filter button styles
            updateFilterButtons();
            
            // Update test history display
            updateTestHistory();
        }

        function clearAllFilters() {
            activeFilters = {
                subject: 'all',
                exam: 'all'
            };
            currentPage = 1;
            
            // Update filter button styles
            updateFilterButtons();
            
            // Update test history display
            updateTestHistory();
        }

        function updateFilterButtons() {
            // Reset all filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            // Highlight active filters
            if (activeFilters.subject === 'all') {
                document.querySelector('button[onclick="filterResults(\'subject\', \'all\')"]').classList.add('bg-blue-600', 'text-white');
                document.querySelector('button[onclick="filterResults(\'subject\', \'all\')"]').classList.remove('bg-gray-200', 'text-gray-700');
            } else {
                const subjectBtn = document.querySelector(`button[onclick="filterResults('subject', '${activeFilters.subject}')"]`);
                if (subjectBtn) {
                    subjectBtn.classList.add('bg-blue-600', 'text-white');
                    subjectBtn.classList.remove('bg-gray-200', 'text-gray-700');
                }
            }
            
            if (activeFilters.exam !== 'all') {
                const examBtn = document.querySelector(`button[onclick="filterResults('exam', '${activeFilters.exam}')"]`);
                if (examBtn) {
                    examBtn.classList.add('bg-blue-600', 'text-white');
                    examBtn.classList.remove('bg-gray-200', 'text-gray-700');
                }
            }
        }

        function getFilteredTestHistory() {
            return testHistory.filter(test => {
                const subjectMatch = activeFilters.subject === 'all' || test.subject === activeFilters.subject;
                const examMatch = activeFilters.exam === 'all' || test.exam === activeFilters.exam;
                return subjectMatch && examMatch;
            });
        }

        // Prevent page refresh on Enter key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && event.target.tagName !== 'BUTTON' && event.target.type !== 'submit') {
                event.preventDefault();
            }
        });

        // Security monitoring functions
        function enableTestSecurity() {
            isTestActive = true;
            tabSwitchWarnings = 0;
            
            // Disable text selection
            document.body.style.userSelect = 'none';
            document.body.style.webkitUserSelect = 'none';
            document.body.style.mozUserSelect = 'none';
            document.body.style.msUserSelect = 'none';
            
            // Disable right-click context menu
            document.addEventListener('contextmenu', preventContextMenu);
            document.addEventListener('visibilitychange', handleVisibilityChange);

            
            // Monitor tab switching/window focus
            document.addEventListener('visibilitychange', handleVisibilityChange);
            window.addEventListener('blur', handleWindowBlur);
            window.addEventListener('focus', handleWindowFocus);
            
            // Disable refresh button and keyboard shortcuts
            window.addEventListener('beforeunload', preventRefresh);
            window.addEventListener('keydown', preventRefreshKeys);
            
            // Show refresh warning
            showRefreshWarning();
        } 
        

        function disableTestSecurity() {
            isTestActive = false;
            
            // Re-enable text selection
            document.body.style.userSelect = '';
            document.body.style.webkitUserSelect = '';
            document.body.style.mozUserSelect = '';
            document.body.style.msUserSelect = '';
            
            // Re-enable right-click
            document.removeEventListener('contextmenu', preventContextMenu);
            
            // Remove monitoring
            document.removeEventListener('visibilitychange', handleVisibilityChange);
            window.removeEventListener('blur', handleWindowBlur);
            window.removeEventListener('focus', handleWindowFocus);
            
            // Re-enable refresh
            window.removeEventListener('beforeunload', preventRefresh);
            window.removeEventListener('keydown', preventRefreshKeys);
            
            // Hide refresh warning
            hideRefreshWarning();
        }

        function preventRefresh(event) {
            if (isTestActive) {
                event.preventDefault();
                event.returnValue = 'Test is in progress! Refreshing will submit your test automatically.';
                return 'Test is in progress! Refreshing will submit your test automatically.';
            }
        }

        function preventRefreshKeys(event) {
            if (isTestActive) {
                // Prevent F5, Ctrl+R, Ctrl+F5, Ctrl+Shift+R
                if (event.key === 'F5' || 
                    (event.ctrlKey && event.key === 'r') || 
                    (event.ctrlKey && event.key === 'R') ||
                    (event.ctrlKey && event.shiftKey && event.key === 'R')) {
                    event.preventDefault();
                    showSecurityWarning('üö´ REFRESH DISABLED\n\nRefreshing is not allowed during the test.\nThis will automatically submit your test!');
                    return false;
                }
            }
        }

        function showRefreshWarning() {
            const warningDiv = document.createElement('div');
            warningDiv.id = 'refreshWarning';
            warningDiv.className = 'fixed top-4 right-4 bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm font-semibold';
            warningDiv.innerHTML = 'üö´ Refresh Disabled During Test';
            document.body.appendChild(warningDiv);
        }

        function hideRefreshWarning() {
            const warningDiv = document.getElementById('refreshWarning');
            if (warningDiv) {
                warningDiv.remove();
            }
        }

        function preventContextMenu(event) {
            if (isTestActive) {
                event.preventDefault();
                return false;
            }
        }

        function handleVisibilityChange() {
            if (isTestActive && document.hidden) {
                handleSecurityViolation('Tab switched or window minimized');
            }
        }

        function handleWindowBlur() {
            if (isTestActive) {
                handleSecurityViolation('Window lost focus');
            }
        }

        function handleWindowFocus() {
            if (isTestActive && tabSwitchWarnings > 0) {
                showSecurityWarning('Focus returned to test window');
            }
        }

        function handleSecurityViolation(reason) {
            tabSwitchWarnings++;
            
            if (tabSwitchWarnings === 1) {
                showSecurityWarning(`‚ö†Ô∏è WARNING: ${reason}\n\nThis is your first warning. The test will be auto-submitted if you switch tabs/windows again.`);
            } else if (tabSwitchWarnings >= 2) {
                showSecurityWarning(`üö® SECURITY VIOLATION: ${reason}\n\nTest is being auto-submitted due to multiple violations.`);
                setTimeout(() => {
                    submitTest('Security violation - auto-submitted');
                }, 2000);
            }
        }



        function showSecurityWarning(message) {
            // Create warning modal
            const warningModal = document.createElement('div');
            warningModal.className = 'fixed inset-0 bg-red-900 bg-opacity-75 flex items-center justify-center z-50';
            warningModal.innerHTML = `
                <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md mx-4 text-center">
                    <div class="text-red-600 text-4xl mb-4">‚ö†Ô∏è</div>
                    <h3 class="text-xl font-bold text-red-800 mb-4">Security Alert</h3>
                    <p class="text-gray-700 mb-6 whitespace-pre-line">${message}</p>
                    <button onclick="this.parentElement.parentElement.remove()" class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold">
                        I Understand
                    </button>
                </div>
            `;
            document.body.appendChild(warningModal);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (warningModal.parentElement) {
                    warningModal.remove();
                }
            }, 5000);
        }



        // Student accounts database - Regular students can only access dashboard, tests, and results
        const userAccounts = {
            'student001': { password: 'exam2024', name: 'Alex Johnson', profilePic: 'AJ', bgColor: 'bg-blue-500' },
            'student002': { password: 'test2024', name: 'Sarah Wilson', profilePic: 'SW', bgColor: 'bg-green-500' },
            'student003': { password: 'study2024', name: 'Mike Chen', profilePic: 'MC', bgColor: 'bg-purple-500' },
            'student004': { password: 'learn2024', name: 'Emma Davis', profilePic: 'ED', bgColor: 'bg-pink-500' },
            'student005': { password: 'prep2024', name: 'Ryan Kumar', profilePic: 'RK', bgColor: 'bg-orange-500' },
            'student006': { password: 'neet2024', name: 'Priya Sharma', profilePic: 'PS', bgColor: 'bg-indigo-500' },
            'student007': { password: 'jee2024', name: 'Arjun Patel', profilePic: 'AP', bgColor: 'bg-teal-500' },
            'student008': { password: 'kcet2024', name: 'Kavya Reddy', profilePic: 'KR', bgColor: 'bg-rose-500' },
            'student009': { password: 'iit2024', name: 'Rohit Singh', profilePic: 'RS', bgColor: 'bg-cyan-500' },
            'student010': { password: 'medical2024', name: 'Ananya Gupta', profilePic: 'AG', bgColor: 'bg-lime-500' }
            
            // üîß TO ADD MORE STUDENTS: Simply add new entries here following this format:
            // 'studentXXX': { password: 'yourpassword', name: 'Full Name', profilePic: 'XX', bgColor: 'bg-color-500' }
            // Available colors: bg-red-500, bg-yellow-500, bg-emerald-500, bg-violet-500, bg-amber-500, etc.
        };

        // User Management accounts database - Separate system with admin privileges
        const managementAccounts = {
            'admin': { password: 'admin123', name: 'System Administrator', profilePic: 'AD', bgColor: 'bg-red-600' },
            'manager': { password: 'manage2024', name: 'User Manager', profilePic: 'UM', bgColor: 'bg-purple-600' },
            'supervisor': { password: 'super2024', name: 'Test Supervisor', profilePic: 'TS', bgColor: 'bg-indigo-600' }
            
            // üîß TO ADD MORE MANAGERS: Add entries here for user management access
            // 'managerXXX': { password: 'yourpassword', name: 'Full Name', profilePic: 'XX', bgColor: 'bg-color-600' }
        };

        // Login function - handles both student and management accounts
        function login(event) {
            event.preventDefault();
            const userId = document.getElementById('studentId').value;
            const password = document.getElementById('password').value;
            
            // Check student accounts first
            if (userAccounts[userId] && userAccounts[userId].password === password) {
                currentUser = userId;
                userManagementAccess = false; // Students don't have management access
                document.getElementById('loginPage').style.display = 'none';
                updateUserProfile();
                loadUserData();
                updateDashboard();
                saveData();
                
                // Hide user management navigation for students
                document.getElementById('userManagementNav').classList.add('hidden');
                
            } else if (managementAccounts[userId] && managementAccounts[userId].password === password) {
                // Management login - different handling
                currentUser = userId;
                userManagementAccess = true; // Full management access
                document.getElementById('loginPage').style.display = 'none';
                updateManagementProfile();
                
                // Show user management navigation for managers
                document.getElementById('userManagementNav').classList.remove('hidden');
                
                // Go directly to user management section
                showSection('userManagement');
                saveData();
                
            } else {
                alert('‚ùå Invalid credentials!\n\nüìö Student Accounts:\n‚Ä¢ student001 / exam2024\n‚Ä¢ student002 / test2024\n‚Ä¢ student003 / study2024\n\nüîê Management Accounts:\n‚Ä¢ admin / admin123\n‚Ä¢ manager / manage2024\n‚Ä¢ supervisor / super2024');
            }
        }

        // Update user profile display for students
        function updateUserProfile() {
            if (currentUser && userAccounts[currentUser]) {
                const user = userAccounts[currentUser];
                document.getElementById('welcomeText').textContent = `Welcome, ${user.name}!`;
                document.getElementById('profileInitials').textContent = user.profilePic;
                document.getElementById('profilePic').className = `w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg`;
                document.getElementById('userIdDisplay').textContent = currentUser;
                
                // Hide reset button for students
                document.getElementById('resetDataBtn').classList.add('hidden');
                
                // Show student navigation for regular students
                showStudentNavigation();
                
                // Update user management section if accessible
                if (userManagementAccess) {
                    updateUserManagementSection();
                }
            }
        }

        // Update management profile display for administrators
        function updateManagementProfile() {
            if (currentUser && managementAccounts[currentUser]) {
                const manager = managementAccounts[currentUser];
                document.getElementById('welcomeText').textContent = `Welcome, ${manager.name}!`;
                document.getElementById('profileInitials').textContent = manager.profilePic;
                document.getElementById('profilePic').className = `w-8 h-8 bg-gradient-to-r from-red-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg`;
                document.getElementById('userIdDisplay').textContent = currentUser;
                
                // Show reset button for management users
                document.getElementById('resetDataBtn').classList.remove('hidden');
                
                // Hide student navigation options for management users
                hideStudentNavigation();
                
                // Show user management navigation for both desktop and mobile
                document.getElementById('userManagementNav').classList.remove('hidden');
                document.getElementById('userManagementNavMobile').classList.remove('hidden');
                
                // Update user management section
                updateUserManagementSection();
            }
        }

        // Hide student navigation for management users
        function hideStudentNavigation() {
            const studentNavItems = ['tests', 'results', 'pyq']; // Hide tests, results, and PYQ for management
            studentNavItems.forEach(navId => {
                const navButton = document.querySelector(`button[onclick="showSection('${navId}')"]`);
                if (navButton) {
                    navButton.style.display = 'none';
                }
            });
        }

        // Show student navigation for regular students
        function showStudentNavigation() {
            const studentNavItems = ['dashboard', 'tests', 'results', 'pyq', 'pdfManager'];
            studentNavItems.forEach(navId => {
                const navButton = document.querySelector(`button[onclick="showSection('${navId}')"]`);
                if (navButton) {
                    navButton.style.display = 'flex';
                }
            });
        }

        // Show exam-specific PDFs
        function showExamPDFs(examName) {
            const modal = document.getElementById('pdfHistoryModal');
            const content = document.getElementById('pdfHistoryContent');
            
            // Update modal title
            const modalTitle = modal.querySelector('h2');
            modalTitle.textContent = `üìã ${examName} PDF Collection`;
            
            // Get sample PDFs for this exam
            const examPDFs = samplePDFs[examName] || [];
            const examDownloads = downloadedQuestions[examName] || [];
            const totalAvailable = pyqQuestionBank[examName] ? pyqQuestionBank[examName].length : 0;
            const remaining = totalAvailable - examDownloads.length;
            
            const examConfigs = {
                'NEET': { icon: 'ü©∫', color: '#dc2626', bgColor: '#fef2f2' },
                'JEE': { icon: '‚öôÔ∏è', color: '#2563eb', bgColor: '#eff6ff' },
                'IIT': { icon: 'üéì', color: '#059669', bgColor: '#ecfdf5' },
                'KCET': { icon: 'üèõÔ∏è', color: '#7c3aed', bgColor: '#f3e8ff' }
            };
            
            const config = examConfigs[examName];
            const downloadCount = Math.ceil(examDownloads.length / 30);
            
            content.innerHTML = `
                <div class="space-y-6">
                    <!-- Header Section -->
                    <div class="border rounded-xl p-6" style="background: ${config.bgColor}; border-color: ${config.color}30;">
                        <div class="flex items-center space-x-4 mb-6">
                            <div class="w-16 h-16 rounded-full flex items-center justify-center" style="background: ${config.color};">
                                <span class="text-white text-2xl">${config.icon}</span>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800">${examName} PDF Collection</h3>
                                <p class="text-gray-600">Complete question papers and study materials</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div class="text-center p-4 bg-white rounded-lg">
                                <p class="text-2xl font-bold" style="color: ${config.color};">${examPDFs.length}</p>
                                <p class="text-sm text-gray-600">Available PDFs</p>
                            </div>
                            <div class="text-center p-4 bg-white rounded-lg">
                                <p class="text-2xl font-bold text-green-600">${totalAvailable}</p>
                                <p class="text-sm text-gray-600">PYQ Questions</p>
                            </div>
                            <div class="text-center p-4 bg-white rounded-lg">
                                <p class="text-2xl font-bold text-orange-600">${examDownloads.length}</p>
                                <p class="text-sm text-gray-600">Downloaded</p>
                            </div>
                            <div class="text-center p-4 bg-white rounded-lg">
                                <p class="text-2xl font-bold text-blue-600">${downloadCount}</p>
                                <p class="text-sm text-gray-600">PYQ PDFs Created</p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <div class="text-sm text-gray-600">
                                <p><strong>Quick Actions:</strong></p>
                                <p>‚Ä¢ Download study materials ‚Ä¢ Take PYQ tests ‚Ä¢ Generate custom PDFs</p>
                            </div>
                            <div class="space-x-3">
                                <button onclick="startPYQTest('${examName}')" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-sm">
                                    üìù Take PYQ Test
                                </button>
                                <button onclick="downloadExamPYQ('${examName}')" class="px-4 py-2 text-white rounded-lg hover:opacity-90 font-semibold text-sm" style="background: ${config.color};" ${remaining === 0 ? 'disabled' : ''}>
                                    ${remaining > 0 ? 'üìÑ Generate PYQ PDF' : 'All PYQ Downloaded'}
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Available PDFs Section -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h4 class="text-xl font-bold text-gray-800 mb-4">üìö Available Study Materials</h4>
                        ${examPDFs.length > 0 ? `
                            <div class="grid gap-4">
                                ${examPDFs.map(pdf => `
                                    <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                                        <div class="flex justify-between items-start">
                                            <div class="flex-1">
                                                <h5 class="font-semibold text-gray-800 mb-2">${pdf.title}</h5>
                                                <p class="text-sm text-gray-600 mb-3">${pdf.description}</p>
                                                <div class="flex items-center space-x-4 text-xs text-gray-500">
                                                    <span class="px-2 py-1 bg-gray-100 rounded">üìñ ${pdf.subject}</span>
                                                    <span class="px-2 py-1 bg-gray-100 rounded">üìÖ ${pdf.year}</span>
                                                    <span class="px-2 py-1 bg-gray-100 rounded">‚ùì ${pdf.questions} Questions</span>
                                                </div>
                                            </div>
                                            <div class="ml-4">
                                                <button onclick="downloadSamplePDF('${examName}', '${pdf.title}')" class="px-4 py-2 text-white rounded-lg hover:opacity-90 font-semibold text-sm" style="background: ${config.color};">
                                                    üì• Download
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div class="text-center py-8 text-gray-500">
                                <p>üìÑ No study materials available yet for ${examName}</p>
                                <p class="text-sm mt-2">Check back later for new PDFs or use the PYQ generator above</p>
                            </div>
                        `}
                    </div>
                    
                    ${examDownloads.length > 0 ? `
                        <!-- Download History Section -->
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <h4 class="text-xl font-bold text-gray-800 mb-4">üìä Your PYQ Download History</h4>
                            <div class="mb-4">
                                <div class="flex justify-between text-sm text-gray-600 mb-2">
                                    <span>PYQ Download Progress</span>
                                    <span>${Math.round((examDownloads.length / totalAvailable) * 100)}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div class="h-3 rounded-full transition-all duration-300" style="width: ${(examDownloads.length / totalAvailable) * 100}%; background: ${config.color};"></div>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div>
                                    <p class="text-gray-600">Subjects covered:</p>
                                    <p class="font-semibold">${[...new Set(examDownloads.map(q => q.subject))].join(', ')}</p>
                                </div>
                                <div>
                                    <p class="text-gray-600">Years covered:</p>
                                    <p class="font-semibold">${[...new Set(examDownloads.map(q => q.year))].join(', ')}</p>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // Download sample PDF function
        function downloadSamplePDF(examName, pdfTitle) {
            // This is a placeholder function - you can implement actual PDF download logic here
            alert(`üìÑ Downloading: ${pdfTitle}\n\n‚úÖ This is a sample PDF for ${examName}.\n\nIn a real implementation, this would download the actual PDF file.\n\nYou can replace this function with actual download logic.`);
        }

        // Update PDF counts on page load
        function updatePDFCounts() {
            const exams = ['NEET', 'JEE', 'IIT', 'KCET'];
            exams.forEach(exam => {
                const samplePDFCount = samplePDFs[exam] ? samplePDFs[exam].length : 0;
                const totalQuestions = pyqQuestionBank[exam] ? pyqQuestionBank[exam].length : 0;
                const downloaded = downloadedQuestions[exam] ? downloadedQuestions[exam].length : 0;
                
                const countElement = document.getElementById(`${exam.toLowerCase()}PdfCount`);
                if (countElement) {
                    countElement.textContent = `${samplePDFCount} Study PDFs ‚Ä¢ ${totalQuestions} PYQ Questions`;
                }
            });
        }

        // PYQ Functions
        function startPYQTest(examName) {
            selectedPYQExam = examName;
            isPYQTest = true;
            
            // Get all questions for the selected exam
            const examQuestions = pyqQuestionBank[examName] || [];
            
            if (examQuestions.length === 0) {
                alert(`‚ùå No PYQ questions available for ${examName} yet.\n\nWe're working on adding more questions. Please check back later!`);
                return;
            }
            
            // Get previously wrong questions for this exam
            const wrongQuestionsForExam = wrongAnsweredQuestions.filter(wrongQ => 
                wrongQ.exam === examName || (wrongQ.isPYQ && wrongQ.originalExam === examName)
            );
            
            // Create question pool with priority for wrong answers
            let questionPool = [];
            
            // Add wrong questions multiple times for higher probability
            wrongQuestionsForExam.forEach(wrongQ => {
                const originalQuestion = examQuestions.find(q => q.question === wrongQ.question);
                if (originalQuestion) {
                    // Add wrong questions 3 times for higher selection probability
                    questionPool.push(originalQuestion);
                    questionPool.push(originalQuestion);
                    questionPool.push(originalQuestion);
                }
            });
            
            // Add all available questions once
            examQuestions.forEach(q => questionPool.push(q));
            
            // Set up PYQ test parameters
            questionCount = Math.min(20, examQuestions.length);
            currentQuestions = getRandomQuestions(questionPool, questionCount);
            currentQuestionIndex = 0;
            userAnswers = new Array(questionCount).fill('');
            markedQuestions = new Array(questionCount).fill(false);
            questionStatus = new Array(questionCount).fill('not-visited');
            questionStatus[0] = 'current';
            testStartTime = Date.now();
            
            // Reset security variables
            tabSwitchWarnings = 0;
            
            // Show test interface
            document.getElementById('pyq').classList.add('hidden');
            document.getElementById('testInterface').classList.remove('hidden');
            
            // Update test title for PYQ
            document.getElementById('testTitle').textContent = `${examName} Previous Year Questions`;
            document.getElementById('testInfo').textContent = `${questionCount} PYQ Questions ‚Ä¢ ${questionCount * 2} Minutes`;
            
            // Initialize question navigator
            initializeQuestionNavigator();
            
            // Load first question
            loadCurrentQuestion();
            
            // Start timer (2 minutes per question)
            startTimer(questionCount * 120);
        }

        function downloadExamPYQ(examName) {
            const examQuestions = pyqQuestionBank[examName] || [];
            
            if (examQuestions.length === 0) {
                alert(`‚ùå No PYQ questions available for ${examName} yet.\n\nWe're working on adding more questions. Please check back later!`);
                return;
            }
            
            // Initialize downloaded questions tracking for this exam
            if (!downloadedQuestions[examName]) {
                downloadedQuestions[examName] = [];
            }
            
            // Get questions that haven't been downloaded yet
            const availableQuestions = examQuestions.filter(q => 
                !downloadedQuestions[examName].some(downloaded => downloaded.question === q.question)
            );
            
            if (availableQuestions.length === 0) {
                alert(`üìÑ All questions for ${examName} have been downloaded!\n\n‚úÖ You have received all available questions in previous PDFs.\n\nTo get new questions, reset your download history or wait for new questions to be added.`);
                return;
            }
            
            // Select up to 30 questions randomly from available questions
            const questionsToDownload = availableQuestions.length <= 30 ? 
                availableQuestions : 
                getRandomQuestions(availableQuestions, 30);
            
            // Mark these questions as downloaded
            downloadedQuestions[examName].push(...questionsToDownload);
            
            // Save download history
            saveData();
            
            const examConfig = {
                'NEET': { 
                    icon: 'ü©∫', 
                    fullName: 'National Eligibility cum Entrance Test',
                    subjects: 'Physics, Chemistry & Biology',
                    color: '#dc2626',
                    bgColor: '#fef2f2'
                },
                'JEE': { 
                    icon: '‚öôÔ∏è', 
                    fullName: 'Joint Entrance Examination',
                    subjects: 'Physics, Chemistry & Mathematics',
                    color: '#2563eb',
                    bgColor: '#eff6ff'
                },
                'IIT': { 
                    icon: 'üéì', 
                    fullName: 'Indian Institute of Technology Advanced',
                    subjects: 'Physics, Chemistry & Mathematics',
                    color: '#059669',
                    bgColor: '#ecfdf5'
                },
                'KCET': { 
                    icon: 'üèõÔ∏è', 
                    fullName: 'Karnataka Common Entrance Test',
                    subjects: 'Physics, Chemistry & Mathematics',
                    color: '#7c3aed',
                    bgColor: '#f3e8ff'
                }
            };
            
            const config = examConfig[examName];
            
            // Create individual exam PDF content
            const pdfContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${examName} PYQ Papers - ExamAce</title>
                    <meta charset="UTF-8">
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { 
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                            line-height: 1.6; 
                            color: #333; 
                            max-width: 800px; 
                            margin: 0 auto; 
                            padding: 20px;
                            background: #f8f9fa;
                            position: relative;
                        }
                        
                        /* MPULE TEST Watermark */
                        body::before {
                            content: "MPULE TEST";
                            position: fixed;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%) rotate(-45deg);
                            font-size: 120px;
                            font-weight: bold;
                            color: rgba(0, 0, 0, 0.05);
                            z-index: -1;
                            pointer-events: none;
                            white-space: nowrap;
                        }
                        
                        @media print {
                            body::before {
                                position: absolute;
                                color: rgba(0, 0, 0, 0.08);
                            }
                        }
                        .container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
                        .header { 
                            text-align: center; 
                            margin-bottom: 40px; 
                            padding: 30px;
                            background: ${config.bgColor};
                            border-radius: 15px;
                            border: 2px solid ${config.color}20;
                        }
                        .header h1 { 
                            color: ${config.color}; 
                            font-size: 32px; 
                            margin-bottom: 10px; 
                            font-weight: 700;
                        }
                        .header h2 { 
                            color: #374151; 
                            font-size: 20px; 
                            margin-bottom: 10px; 
                            font-weight: 600;
                        }
                        .header p { color: #6b7280; font-size: 14px; }
                        
                        .stats-box {
                            background: ${config.bgColor};
                            border: 2px solid ${config.color}30;
                            border-radius: 10px;
                            padding: 20px;
                            margin-bottom: 30px;
                            text-align: center;
                        }
                        
                        .question { 
                            margin-bottom: 30px; 
                            padding: 25px; 
                            border-radius: 10px; 
                            border-left: 5px solid ${config.color};
                            background: white;
                            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                        }
                        
                        .question-header { 
                            font-size: 18px; 
                            font-weight: 700; 
                            margin-bottom: 15px; 
                            color: ${config.color};
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                        }
                        
                        .year-badge {
                            background: ${config.color};
                            color: white;
                            padding: 4px 12px;
                            border-radius: 20px;
                            font-size: 12px;
                            font-weight: 600;
                        }
                        
                        .subject-chapter {
                            background: ${config.color}20;
                            color: ${config.color};
                            padding: 2px 8px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 600;
                            margin-bottom: 15px;
                            display: inline-block;
                        }
                        
                        .question-text { 
                            font-size: 16px; 
                            margin-bottom: 20px; 
                            color: #1f2937; 
                            font-weight: 500;
                            line-height: 1.7;
                        }
                        
                        .options { 
                            margin-bottom: 20px;
                        }
                        
                        .option {
                            padding: 8px 15px;
                            margin: 5px 0;
                            border-radius: 8px;
                            background: #f9fafb;
                            border: 1px solid #e5e7eb;
                        }
                        
                        .correct-option {
                            background: #dcfce7 !important;
                            border-color: #16a34a !important;
                            font-weight: 600;
                            color: #15803d;
                        }
                        
                        .answer-section {
                            background: #f0f9ff;
                            border: 1px solid #0ea5e9;
                            border-radius: 8px;
                            padding: 15px;
                            margin-top: 15px;
                        }
                        
                        .answer-label {
                            font-weight: 700;
                            color: #0c4a6e;
                            margin-bottom: 8px;
                        }
                        
                        .explanation {
                            color: #374151;
                            line-height: 1.6;
                        }
                        
                        .footer { 
                            margin-top: 40px; 
                            padding-top: 20px; 
                            border-top: 2px solid #e5e7eb; 
                            text-align: center; 
                            color: #6b7280; 
                            font-size: 12px; 
                        }
                        .footer strong { color: #374151; }
                        
                        @media print {
                            body { background: white; }
                            .container { box-shadow: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1>${config.icon} ${examName} Previous Year Questions</h1>
                            <h2>${config.fullName}</h2>
                            <p>${config.subjects} ‚Ä¢ Complete Question Bank with Solutions</p>
                        </div>
                        
                        <div class="stats-box">
                            <h3 style="color: ${config.color}; font-size: 18px; margin-bottom: 10px;">üìä Question Bank Statistics</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; text-align: center;">
                                <div>
                                    <p style="font-size: 24px; font-weight: bold; color: ${config.color};">${questionsToDownload.length}</p>
                                    <p style="font-size: 12px; color: #6b7280;">Questions in PDF</p>
                                </div>
                                <div>
                                    <p style="font-size: 24px; font-weight: bold; color: ${config.color};">${[...new Set(questionsToDownload.map(q => q.year))].length}</p>
                                    <p style="font-size: 12px; color: #6b7280;">Years Covered</p>
                                </div>
                                <div>
                                    <p style="font-size: 24px; font-weight: bold; color: ${config.color};">${[...new Set(questionsToDownload.map(q => q.subject))].length}</p>
                                    <p style="font-size: 12px; color: #6b7280;">Subjects</p>
                                </div>
                                <div>
                                    <p style="font-size: 24px; font-weight: bold; color: ${config.color};">${availableQuestions.length}</p>
                                    <p style="font-size: 12px; color: #6b7280;">Remaining</p>
                                </div>
                            </div>
                        </div>
                        
                        ${questionsToDownload.map((q, index) => {
                            const correctOption = q.options.find(opt => opt.startsWith(q.correct));
                            return `
                                <div class="question">
                                    <div class="question-header">
                                        <span>Question ${index + 1}</span>
                                        <span class="year-badge">${q.year}</span>
                                    </div>
                                    
                                    <div class="subject-chapter">${q.subject} ‚Ä¢ ${q.chapter}</div>
                                    
                                    <div class="question-text">${q.question}</div>
                                    
                                    <div class="options">
                                        ${q.options.map(option => `
                                            <div class="option ${option.startsWith(q.correct) ? 'correct-option' : ''}">
                                                ${option}
                                            </div>
                                        `).join('')}
                                    </div>
                                    
                                    <div class="answer-section">
                                        <div class="answer-label">‚úÖ Correct Answer: ${correctOption}</div>
                                        <div class="explanation">
                                            <strong>Explanation:</strong><br>
                                            ${q.explanation}
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                        
                        <div class="footer">
                            <p><strong>Generated by ExamAce</strong> - Your Competitive Exam Preparation Platform</p>
                            <p>${examName} PYQ Collection ‚Ä¢ Generated on ${new Date().toLocaleDateString()}</p>
                            <p style="margin-top: 10px; font-size: 11px;">For support: mpulseinstitutions@gmail.com</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Create and download the PDF
            const blob = new Blob([pdfContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `${examName}_PYQ_Papers_${new Date().toISOString().split('T')[0]}.html`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert(`üìÑ ${examName} PYQ Papers Downloaded Successfully!\n\n‚úÖ What's included:\n‚Ä¢ ${questionsToDownload.length} Previous Year Questions\n‚Ä¢ ${config.subjects}\n‚Ä¢ Complete solutions with explanations\n‚Ä¢ Year-wise organization\n‚Ä¢ Professional formatting\n‚Ä¢ Print-ready layout\n\nüìä Download Status:\n‚Ä¢ Questions in this PDF: ${questionsToDownload.length}\n‚Ä¢ Remaining questions: ${availableQuestions.length - questionsToDownload.length}\n‚Ä¢ Total available: ${examQuestions.length}\n\nOpen the HTML file in any browser to view or print as PDF.`);
        }

        function showAllPDFs() {
            const modal = document.getElementById('pdfHistoryModal');
            const content = document.getElementById('pdfHistoryContent');
            
            // Check if any PDFs have been downloaded
            const hasDownloads = Object.keys(downloadedQuestions).some(exam => 
                downloadedQuestions[exam] && downloadedQuestions[exam].length > 0
            );
            
            if (!hasDownloads) {
                content.innerHTML = `
                    <div class="text-center py-12">
                        <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-gray-400 text-4xl">üìÑ</span>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">No PDFs Downloaded Yet</h3>
                        <p class="text-gray-600 mb-6">Start downloading PYQ papers to see your history here!</p>
                        <button onclick="closePDFHistoryModal()" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">
                            Start Downloading
                        </button>
                    </div>
                `;
            } else {
                // Generate PDF history content
                const examConfigs = {
                    'NEET': { icon: 'ü©∫', color: '#dc2626', bgColor: '#fef2f2' },
                    'JEE': { icon: '‚öôÔ∏è', color: '#2563eb', bgColor: '#eff6ff' },
                    'IIT': { icon: 'üéì', color: '#059669', bgColor: '#ecfdf5' },
                    'KCET': { icon: 'üèõÔ∏è', color: '#7c3aed', bgColor: '#f3e8ff' }
                };
                
                content.innerHTML = Object.keys(downloadedQuestions)
                    .filter(exam => downloadedQuestions[exam] && downloadedQuestions[exam].length > 0)
                    .map(exam => {
                        const config = examConfigs[exam];
                        const downloaded = downloadedQuestions[exam];
                        const totalAvailable = pyqQuestionBank[exam] ? pyqQuestionBank[exam].length : 0;
                        const remaining = totalAvailable - downloaded.length;
                        const downloadCount = Math.ceil(downloaded.length / 30); // Assuming 30 questions per PDF
                        
                        return `
                            <div class="border rounded-xl p-6" style="background: ${config.bgColor}; border-color: ${config.color}30;">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background: ${config.color};">
                                            <span class="text-white text-xl">${config.icon}</span>
                                        </div>
                                        <div>
                                            <h3 class="text-xl font-bold text-gray-800">${exam} PYQ Papers</h3>
                                            <p class="text-sm text-gray-600">Downloaded ${downloaded.length} of ${totalAvailable} questions</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-2xl font-bold" style="color: ${config.color};">${downloadCount}</p>
                                        <p class="text-sm text-gray-600">PDFs Downloaded</p>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                                    <div class="text-center">
                                        <p class="text-lg font-semibold" style="color: ${config.color};">${downloaded.length}</p>
                                        <p class="text-xs text-gray-600">Downloaded</p>
                                    </div>
                                    <div class="text-center">
                                        <p class="text-lg font-semibold text-gray-700">${remaining}</p>
                                        <p class="text-xs text-gray-600">Remaining</p>
                                    </div>
                                    <div class="text-center">
                                        <p class="text-lg font-semibold text-blue-600">${[...new Set(downloaded.map(q => q.subject))].length}</p>
                                        <p class="text-xs text-gray-600">Subjects</p>
                                    </div>
                                    <div class="text-center">
                                        <p class="text-lg font-semibold text-green-600">${[...new Set(downloaded.map(q => q.year))].length}</p>
                                        <p class="text-xs text-gray-600">Years</p>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <div class="flex justify-between text-sm text-gray-600 mb-1">
                                        <span>Progress</span>
                                        <span>${Math.round((downloaded.length / totalAvailable) * 100)}%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="h-2 rounded-full transition-all duration-300" style="width: ${(downloaded.length / totalAvailable) * 100}%; background: ${config.color};"></div>
                                    </div>
                                </div>
                                
                                <div class="flex justify-between items-center">
                                    <div class="text-sm text-gray-600">
                                        <p><strong>Recent subjects:</strong> ${[...new Set(downloaded.slice(-10).map(q => q.subject))].join(', ')}</p>
                                    </div>
                                    <button onclick="downloadExamPYQ('${exam}')" class="px-4 py-2 text-white rounded-lg hover:opacity-90 font-semibold text-sm" style="background: ${config.color};" ${remaining === 0 ? 'disabled' : ''}>
                                        ${remaining > 0 ? 'Download More' : 'All Downloaded'}
                                    </button>
                                </div>
                            </div>
                        `;
                    }).join('');
            }
            
            modal.classList.remove('hidden');
        }

        function closePDFHistoryModal() {
            document.getElementById('pdfHistoryModal').classList.add('hidden');
        }

        function resetPDFHistory() {
            if (confirm('‚ö†Ô∏è Are you sure you want to reset your PDF download history?\n\nThis will allow you to download all questions again, but your current download progress will be lost.')) {
                downloadedQuestions = {};
                saveData();
                closePDFHistoryModal();
                alert('‚úÖ PDF download history has been reset!\n\nYou can now download all questions again.');
            }
        }

        function downloadPYQPaper() {
            // Create comprehensive PYQ paper with all exams
            const allExamQuestions = {
                'NEET': pyqQuestionBank.NEET || [],
                'JEE': pyqQuestionBank.JEE || [],
                'IIT': pyqQuestionBank.IIT || [],
                'KCET': pyqQuestionBank.KCET || []
            };
            
            // Create comprehensive PDF content
            const pdfContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Complete PYQ Papers - ExamAce</title>
                    <meta charset="UTF-8">
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { 
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                            line-height: 1.6; 
                            color: #333; 
                            max-width: 800px; 
                            margin: 0 auto; 
                            padding: 20px;
                            background: #f8f9fa;
                            position: relative;
                        }
                        
                        /* MPULE TEST Watermark */
                        body::before {
                            content: "MPULE TEST";
                            position: fixed;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%) rotate(-45deg);
                            font-size: 120px;
                            font-weight: bold;
                            color: rgba(0, 0, 0, 0.05);
                            z-index: -1;
                            pointer-events: none;
                            white-space: nowrap;
                        }
                        
                        @media print {
                            body::before {
                                position: absolute;
                                color: rgba(0, 0, 0, 0.08);
                            }
                        }
                        .container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
                        .header { 
                            text-align: center; 
                            margin-bottom: 40px; 
                            padding-bottom: 20px; 
                            border-bottom: 3px solid #3b82f6;
                        }
                        .header h1 { 
                            color: #1e40af; 
                            font-size: 32px; 
                            margin-bottom: 10px; 
                            font-weight: 700;
                        }
                        .header h2 { 
                            color: #374151; 
                            font-size: 24px; 
                            margin-bottom: 10px; 
                            font-weight: 600;
                        }
                        .header p { color: #6b7280; font-size: 14px; }
                        
                        .exam-section {
                            margin-bottom: 50px;
                            padding: 30px;
                            border-radius: 15px;
                            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                            border: 2px solid #e2e8f0;
                        }
                        
                        .exam-title {
                            font-size: 28px;
                            font-weight: 700;
                            margin-bottom: 20px;
                            text-align: center;
                            padding: 15px;
                            border-radius: 10px;
                            color: white;
                        }
                        
                        .neet-title { background: linear-gradient(135deg, #dc2626, #ef4444); }
                        .jee-title { background: linear-gradient(135deg, #2563eb, #3b82f6); }
                        .iit-title { background: linear-gradient(135deg, #059669, #10b981); }
                        .kcet-title { background: linear-gradient(135deg, #7c3aed, #8b5cf6); }
                        
                        .question { 
                            margin-bottom: 30px; 
                            padding: 25px; 
                            border-radius: 10px; 
                            border-left: 5px solid #3b82f6;
                            background: white;
                            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                        }
                        
                        .question-header { 
                            font-size: 18px; 
                            font-weight: 700; 
                            margin-bottom: 15px; 
                            color: #1e40af;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                        }
                        
                        .year-badge {
                            background: #3b82f6;
                            color: white;
                            padding: 4px 12px;
                            border-radius: 20px;
                            font-size: 12px;
                            font-weight: 600;
                        }
                        
                        .subject-chapter {
                            background: #e0e7ff;
                            color: #3730a3;
                            padding: 2px 8px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 600;
                            margin-bottom: 15px;
                            display: inline-block;
                        }
                        
                        .question-text { 
                            font-size: 16px; 
                            margin-bottom: 20px; 
                            color: #1f2937; 
                            font-weight: 500;
                            line-height: 1.7;
                        }
                        
                        .options { 
                            margin-bottom: 20px;
                        }
                        
                        .option {
                            padding: 8px 15px;
                            margin: 5px 0;
                            border-radius: 8px;
                            background: #f9fafb;
                            border: 1px solid #e5e7eb;
                        }
                        
                        .correct-option {
                            background: #dcfce7 !important;
                            border-color: #16a34a !important;
                            font-weight: 600;
                            color: #15803d;
                        }
                        
                        .answer-section {
                            background: #f0f9ff;
                            border: 1px solid #0ea5e9;
                            border-radius: 8px;
                            padding: 15px;
                            margin-top: 15px;
                        }
                        
                        .answer-label {
                            font-weight: 700;
                            color: #0c4a6e;
                            margin-bottom: 8px;
                        }
                        
                        .explanation {
                            color: #374151;
                            line-height: 1.6;
                        }
                        
                        .footer { 
                            margin-top: 40px; 
                            padding-top: 20px; 
                            border-top: 2px solid #e5e7eb; 
                            text-align: center; 
                            color: #6b7280; 
                            font-size: 12px; 
                        }
                        .footer strong { color: #374151; }
                        
                        @media print {
                            body { background: white; }
                            .container { box-shadow: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1>üìö Complete PYQ Papers Collection</h1>
                            <h2>NEET ‚Ä¢ JEE ‚Ä¢ IIT ‚Ä¢ KCET</h2>
                            <p>Comprehensive collection of previous year questions with detailed explanations</p>
                        </div>
                        
                        ${Object.entries(allExamQuestions).map(([examName, questions]) => {
                            if (questions.length === 0) return '';
                            
                            const examConfig = {
                                'NEET': { icon: 'ü©∫', class: 'neet-title' },
                                'JEE': { icon: '‚öôÔ∏è', class: 'jee-title' },
                                'IIT': { icon: 'üéì', class: 'iit-title' },
                                'KCET': { icon: 'üèõÔ∏è', class: 'kcet-title' }
                            };
                            
                            const config = examConfig[examName];
                            
                            return `
                                <div class="exam-section">
                                    <div class="exam-title ${config.class}">
                                        ${config.icon} ${examName} Previous Year Questions
                                    </div>
                                    
                                    ${questions.map((q, index) => {
                                        const correctOption = q.options.find(opt => opt.startsWith(q.correct));
                                        return `
                                            <div class="question">
                                                <div class="question-header">
                                                    <span>Question ${index + 1}</span>
                                                    <span class="year-badge">${q.year}</span>
                                                </div>
                                                
                                                <div class="subject-chapter">${q.subject} ‚Ä¢ ${q.chapter}</div>
                                                
                                                <div class="question-text">${q.question}</div>
                                                
                                                <div class="options">
                                                    ${q.options.map(option => `
                                                        <div class="option ${option.startsWith(q.correct) ? 'correct-option' : ''}">
                                                            ${option}
                                                        </div>
                                                    `).join('')}
                                                </div>
                                                
                                                <div class="answer-section">
                                                    <div class="answer-label">‚úÖ Correct Answer: ${correctOption}</div>
                                                    <div class="explanation">
                                                        <strong>Explanation:</strong><br>
                                                        ${q.explanation}
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            `;
                        }).join('')}
                        
                        <div class="footer">
                            <p><strong>Generated by ExamAce</strong> - Your Competitive Exam Preparation Platform</p>
                            <p>Complete PYQ Collection ‚Ä¢ Generated on ${new Date().toLocaleDateString()}</p>
                            <p style="margin-top: 10px; font-size: 11px;">For support: mpulseinstitutions@gmail.com</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Create and download the PDF
            const blob = new Blob([pdfContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `Complete_PYQ_Papers_${new Date().toISOString().split('T')[0]}.html`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            // Calculate total questions
            const totalQuestions = Object.values(allExamQuestions).reduce((total, questions) => total + questions.length, 0);
            
            alert(`üìÑ Complete PYQ Papers Downloaded Successfully!\n\n‚úÖ What's included:\n‚Ä¢ ${totalQuestions} Previous Year Questions\n‚Ä¢ All 4 exams: NEET, JEE, IIT, KCET\n‚Ä¢ Complete solutions with explanations\n‚Ä¢ Year-wise organization\n‚Ä¢ Subject and chapter categorization\n‚Ä¢ Professional formatting\n‚Ä¢ Print-ready layout\n\nOpen the HTML file in any browser to view or print as PDF.`);
        }

        // Update user management section
        function updateUserManagementSection() {
            // Show current manager info (not student info)
            if (currentUser && managementAccounts[currentUser]) {
                const manager = managementAccounts[currentUser];
                
                // Update current user profile to show manager info
                document.getElementById('currentUserName').textContent = manager.name;
                document.getElementById('currentUserId').textContent = currentUser;
                document.getElementById('currentUserInitials').textContent = manager.profilePic;
                document.getElementById('currentUserPic').className = `w-16 h-16 ${manager.bgColor} rounded-full flex items-center justify-center`;
                document.getElementById('currentUserStats').textContent = `Management Access ‚Ä¢ Full System Control`;
            }
            
            // Update all users list
            updateAllUsersList();
        }

        // Update all users list - only show student accounts
        function updateAllUsersList() {
            const container = document.getElementById('allUsersList');
            container.innerHTML = '';
            
            Object.keys(userAccounts).forEach(userId => {
                const user = userAccounts[userId];
                const userData = JSON.parse(localStorage.getItem(`examAceData_${userId}`)) || {};
                
                const userCard = document.createElement('div');
                userCard.className = 'border rounded-lg p-4 border-gray-200';
                userCard.innerHTML = `
                    <div class="flex items-center space-x-3 mb-3">
                        <div class="w-10 h-10 ${user.bgColor} rounded-full flex items-center justify-center">
                            <span class="text-white text-sm font-bold">${user.profilePic}</span>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">${user.name}</h4>
                            <p class="text-sm text-gray-600">${userId}</p>
                        </div>
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">Student</span>
                    </div>
                    <div class="text-xs text-gray-500 space-y-1">
                        <p>Tests: ${userData.totalTests || 0}</p>
                        <p>Best Score: ${userData.bestScore || 0}%</p>
                        <p>Avg Score: ${userData.totalTests > 0 ? Math.round((userData.totalScore || 0) / userData.totalTests) : 0}%</p>
                    </div>
                    <div class="mt-3 flex space-x-2">
                        <button onclick="resetUserData('${userId}')" class="text-xs px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600" title="Reset this student's data">
                            Reset Data
                        </button>
                        <button onclick="viewUserDetails('${userId}')" class="text-xs px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600" title="View detailed statistics">
                            View Details
                        </button>
                    </div>
                `;
                container.appendChild(userCard);
            });
        }

        // Add new user function
        function addNewUser(event) {
            event.preventDefault();
            
            const userId = document.getElementById('newUserId').value.trim();
            const password = document.getElementById('newUserPassword').value.trim();
            const name = document.getElementById('newUserName').value.trim();
            const color = document.getElementById('newUserColor').value;
            
            // Validation
            if (userAccounts[userId]) {
                alert('‚ùå User ID already exists! Please choose a different ID.');
                return;
            }
            
            if (userId.length < 3) {
                alert('‚ùå User ID must be at least 3 characters long.');
                return;
            }
            
            if (password.length < 4) {
                alert('‚ùå Password must be at least 4 characters long.');
                return;
            }
            
            // Generate profile initials
            const nameParts = name.split(' ');
            const profilePic = nameParts.length > 1 ? 
                (nameParts[0].charAt(0) + nameParts[1].charAt(0)).toUpperCase() : 
                name.substring(0, 2).toUpperCase();
            
            // Add new user to accounts
            userAccounts[userId] = {
                password: password,
                name: name,
                profilePic: profilePic,
                bgColor: color
            };
            
            // Save user accounts to localStorage for persistence
            localStorage.setItem('examAceUserAccounts', JSON.stringify(userAccounts));
            
            // Clear form
            document.getElementById('newUserId').value = '';
            document.getElementById('newUserPassword').value = '';
            document.getElementById('newUserName').value = '';
            document.getElementById('newUserColor').value = 'bg-red-500';
            
            // Update displays
            updateAllUsersList();
            
            alert(`‚úÖ User account created successfully!\n\nUser ID: ${userId}\nPassword: ${password}\nName: ${name}\n\nThe user can now log in with these credentials.\n\n‚ö†Ô∏è Note: New accounts are automatically saved and will persist even after page refresh.`);
        }



        // Reset specific user data - only management can access this
        function resetUserData(userId) {
            const user = userAccounts[userId];
            
            // Only management accounts can reset student data
            if (!userManagementAccess) {
                alert('‚ùå Access Denied!\n\nThis function is only available to User Management accounts.\n\nStudents cannot reset data through this interface.');
                return;
            }
            
            const confirmMessage = `‚ö†Ô∏è Are you sure you want to reset all data for ${user.name} (${userId})?\n\nThis will permanently delete:\n‚Ä¢ All test history and results\n‚Ä¢ Dashboard statistics\n‚Ä¢ Performance data\n‚Ä¢ Study progress\n\nThis action cannot be undone!`;
            
            if (confirm(confirmMessage)) {
                // Clear the specific user's data
                localStorage.removeItem(`examAceData_${userId}`);
                
                // If this is the currently logged in user, also reset session data
                if (currentUser === userId) {
                    testHistory = [];
                    totalTests = 0;
                    totalScore = 0;
                    bestScore = 0;
                    wrongAnsweredQuestions = [];
                }
                
                updateAllUsersList();
                
                alert(`‚úÖ All data for ${user.name} (${userId}) has been reset successfully!`);
            }
        }

        // View user details function
        function viewUserDetails(userId) {
            const user = userAccounts[userId];
            const userData = JSON.parse(localStorage.getItem(`examAceData_${userId}`)) || {};
            
            const testHistory = userData.testHistory || [];
            const recentTests = testHistory.slice(-5).reverse();
            
            let detailsMessage = `üìä Detailed Statistics for ${user.name} (${userId})\n\n`;
            detailsMessage += `üìà Overall Performance:\n`;
            detailsMessage += `‚Ä¢ Total Tests: ${userData.totalTests || 0}\n`;
            detailsMessage += `‚Ä¢ Best Score: ${userData.bestScore || 0}%\n`;
            detailsMessage += `‚Ä¢ Average Score: ${userData.totalTests > 0 ? Math.round((userData.totalScore || 0) / userData.totalTests) : 0}%\n`;
            detailsMessage += `‚Ä¢ Total Score Points: ${userData.totalScore || 0}\n\n`;
            
            if (recentTests.length > 0) {
                detailsMessage += `üìù Recent Test History (Last 5):\n`;
                recentTests.forEach((test, index) => {
                    detailsMessage += `${index + 1}. ${test.exam} - ${test.subject} (${test.score}%) - ${test.date}\n`;
                });
            } else {
                detailsMessage += `üìù No test history available\n`;
            }
            
            alert(detailsMessage);
        }

        // Export user data
        function exportUserData() {
            const allData = {};
            
            Object.keys(userAccounts).forEach(userId => {
                const userData = JSON.parse(localStorage.getItem(`examAceData_${userId}`)) || {};
                allData[userId] = {
                    profile: userAccounts[userId],
                    data: userData
                };
            });
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `examace_data_export_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('‚úÖ User data exported successfully! Check your downloads folder.');
        }

        // Show reset all modal
        function showResetAllModal() {
            document.getElementById('resetAllModal').classList.remove('hidden');
        }

        // Close reset all modal
        function closeResetAllModal() {
            document.getElementById('resetAllModal').classList.add('hidden');
        }

        // Confirm reset all users data - only for management
        function confirmResetAll() {
            // Check if user has management access
            if (!userManagementAccess) {
                alert('‚ùå Access Denied!\n\nThis function is only available to User Management accounts.\n\nThis action requires administrative privileges.');
                return;
            }
            
            if (confirm('üö® FINAL WARNING!\n\nThis will permanently delete ALL data for ALL STUDENTS!\n\nType "DELETE ALL" to confirm:') === true) {
                const confirmation = prompt('Type "DELETE ALL" to confirm (case sensitive):');
                if (confirmation === 'DELETE ALL') {
                    // Clear all student data
                    Object.keys(userAccounts).forEach(userId => {
                        localStorage.removeItem(`examAceData_${userId}`);
                    });
                    
                    // Update displays
                    updateAllUsersList();
                    
                    // Close modal
                    closeResetAllModal();
                    
                    alert(`‚úÖ ALL student data has been permanently deleted!\n\nAll ${Object.keys(userAccounts).length} student accounts now have fresh, empty data.`);
                } else {
                    alert('‚ùå Confirmation text did not match. Reset cancelled.');
                }
            }
        }

        // Load user-specific data
        function loadUserData() {
            const userData = JSON.parse(localStorage.getItem(`examAceData_${currentUser}`)) || {};
            testHistory = userData.testHistory || [];
            totalTests = userData.totalTests || 0;
            totalScore = userData.totalScore || 0;
            bestScore = userData.bestScore || 0;
            wrongAnsweredQuestions = userData.wrongAnsweredQuestions || [];
            currentPage = userData.currentPage || 1;
            activeFilters = userData.activeFilters || { subject: 'all', exam: 'all' }; // Load saved filters
            downloadedQuestions = userData.downloadedQuestions || {}; // Load PDF download tracking
            availablePDFs = userData.availablePDFs || {}; // Load available PDFs tracking
            updateTestHistory();
        }

        // Logout function - handles both student and management logout
        function logout() {
            // Save current user data before logout (only for students)
            if (currentUser && userAccounts[currentUser]) {
                saveUserData();
            }
            
            // Clear current user and access
            currentUser = '';
            userManagementAccess = false;
            
            // Reset profile display
            document.getElementById('welcomeText').textContent = 'Welcome, Student!';
            document.getElementById('profileInitials').textContent = 'S';
            document.getElementById('profilePic').className = 'w-8 h-8 bg-primary rounded-full flex items-center justify-center';
            document.getElementById('userIdDisplay').textContent = '';
            
            // Show all navigation items again (restore default state)
            showStudentNavigation();
            
            // Hide user management navigation
            document.getElementById('userManagementNav').classList.add('hidden');
            
            // Clear login form
            document.getElementById('studentId').value = '';
            document.getElementById('password').value = '';
            
            // Show login page
            document.getElementById('loginPage').style.display = 'flex';
            
            // Save global state
            saveData();
        }

        // Sample PDF Collection - You can add more PDFs here manually
        const samplePDFs = {
            NEET: [
                {
                    title: "NEET 2024 Physics Complete Solutions",
                    description: "Complete physics questions from NEET 2024 with detailed solutions covering Mechanics, Thermodynamics, Optics, and Modern Physics",
                    subject: "Physics",
                    year: "2024",
                    questions: 45,
                    downloadUrl: ""
                },
                {
                    title: "NEET 2023 Chemistry Analysis",
                    description: "Comprehensive chemistry question bank with explanations covering Organic, Inorganic, and Physical Chemistry",
                    subject: "Chemistry", 
                    year: "2023",
                    questions: 45,
                    downloadUrl: "#"
                },
                {
                    title: "NEET Biology Previous Years (2022-2024)",
                    description: "Biology questions from multiple years with solutions covering Cell Biology, Genetics, Human Physiology, and Ecology",
                    subject: "Biology",
                    year: "2022-2024",
                    questions: 90,
                    downloadUrl: "#"
                },
                {
                    title: "NEET 2024 Complete Question Paper",
                    description: "Full NEET 2024 question paper with all 180 questions and detailed answer key",
                    subject: "All Subjects",
                    year: "2024",
                    questions: 180,
                    downloadUrl: "#"
                },
                {
                    title: "NEET Physics Mechanics Chapter Wise",
                    description: "Chapter-wise physics questions focusing on Mechanics with step-by-step solutions",
                    subject: "Physics",
                    year: "2020-2024",
                    questions: 60,
                    downloadUrl: "#"
                },
                {
                    title: "NEET Organic Chemistry Master Collection",
                    description: "Comprehensive organic chemistry questions with reaction mechanisms and explanations",
                    subject: "Chemistry",
                    year: "2019-2024",
                    questions: 75,
                    downloadUrl: "#"
                },
                {
                    title: "NEET Human Physiology Deep Dive",
                    description: "Detailed human physiology questions covering all body systems with diagrams",
                    subject: "Biology",
                    year: "2021-2024",
                    questions: 55,
                    downloadUrl: "#"
                },
                {
                    title: "NEET 2023 Complete Analysis Report",
                    description: "Complete analysis of NEET 2023 with difficulty level, topic distribution, and solutions",
                    subject: "All Subjects",
                    year: "2023",
                    questions: 180,
                    downloadUrl: "#"
                },
                {
                    title: "NEET Mock Test Series - Set 1",
                    description: "Practice test series designed to match NEET pattern with detailed explanations",
                    subject: "All Subjects",
                    year: "2024",
                    questions: 180,
                    downloadUrl: "#"
                },
                {
                    title: "NEET Botany and Zoology Combined",
                    description: "Comprehensive collection of botany and zoology questions from previous years",
                    subject: "Biology",
                    year: "2018-2024",
                    questions: 120,
                    downloadUrl: "#"
                }
            ],
            JEE: [
                {
                    title: "JEE Main 2024 Mathematics",
                    description: "Complete mathematics section with step-by-step solutions",
                    subject: "Mathematics",
                    year: "2024", 
                    questions: 30,
                    downloadUrl: "#"
                },
                {
                    title: "JEE Physics Mechanics",
                    description: "Mechanics questions from JEE Main and Advanced",
                    subject: "Physics",
                    year: "2023-2024",
                    questions: 40,
                    downloadUrl: "#"
                }
            ],
            IIT: [
                {
                    title: "IIT Advanced 2024 Complete",
                    description: "Full question paper with detailed analysis",
                    subject: "All Subjects",
                    year: "2024",
                    questions: 54,
                    downloadUrl: "#"
                }
            ],
            KCET: [
                {
                    title: "KCET 2024 Physics & Chemistry",
                    description: "Combined physics and chemistry question bank",
                    subject: "Physics & Chemistry",
                    year: "2024",
                    questions: 120,
                    downloadUrl: "#"
                }
            ]
        };

        // PYQ Question Bank - Real Previous Year Questions (Separate from regular test questions)
        const pyqQuestionBank = {
            NEET: [
                // 2025 Questions
                {
                    question: "The process of DNA replication occurs during which phase of the cell cycle?",
                    options: ["A) G1 phase", "B) S phase", "C) G2 phase", "D) M phase"],
                    correct: "B",
                    year: "2025",
                    subject: "Biology",
                    chapter: "Cell Biology",
                    explanation: "DNA replication occurs during the S (Synthesis) phase of the cell cycle, where the entire genome is duplicated to prepare for cell division."
                },
                {
                    question: "Which enzyme is responsible for unwinding the DNA double helix during replication?",
                    options: ["A) DNA polymerase", "B) DNA ligase", "C) Helicase", "D) Primase"],
                    correct: "C",
                    year: "2025",
                    subject: "Biology",
                    chapter: "Molecular Biology",
                    explanation: "Helicase is the enzyme that unwinds the DNA double helix by breaking hydrogen bonds between base pairs, creating replication forks."
                },
                {
                    question: "The photoelectric effect demonstrates that light has:",
                    options: ["A) Only wave properties", "B) Only particle properties", "C) Both wave and particle properties", "D) Neither wave nor particle properties"],
                    correct: "B",
                    year: "2025",
                    subject: "Physics",
                    chapter: "Modern Physics",
                    explanation: "The photoelectric effect can only be explained by considering light as particles (photons) with discrete energy packets, not as continuous waves."
                },
                {
                    question: "The work function of a metal is the minimum energy required to:",
                    options: ["A) Excite an electron", "B) Remove an electron from the surface", "C) Create a photon", "D) Ionize an atom"],
                    correct: "B",
                    year: "2025",
                    subject: "Physics",
                    chapter: "Modern Physics",
                    explanation: "Work function is the minimum energy needed to remove an electron from the surface of a metal, overcoming the binding energy."
                },
                {
                    question: "Which of the following compounds exhibits optical isomerism?",
                    options: ["A) CH‚ÇÉ-CH‚ÇÇ-CH‚ÇÇ-CH‚ÇÉ", "B) CH‚ÇÉ-CHCl-CH‚ÇÇ-CH‚ÇÉ", "C) CH‚ÇÉ-CHCl-CHCl-CH‚ÇÉ", "D) CH‚ÇÉ-CH(OH)-COOH"],
                    correct: "D",
                    year: "2025",
                    subject: "Chemistry",
                    chapter: "Organic Chemistry",
                    explanation: "Lactic acid (CH‚ÇÉ-CH(OH)-COOH) has a chiral carbon atom bonded to four different groups, making it optically active."
                },
                {
                    question: "The hybridization of the central atom in SF‚ÇÜ is:",
                    options: ["A) sp¬≥", "B) sp¬≥d", "C) sp¬≥d¬≤", "D) sp¬≥d¬≥"],
                    correct: "C",
                    year: "2025",
                    subject: "Chemistry",
                    chapter: "Chemical Bonding",
                    explanation: "SF‚ÇÜ has 6 bonding pairs around sulfur, requiring sp¬≥d¬≤ hybridization to accommodate the octahedral geometry."
                },
                
                // 2024 Questions
                {
                    question: "Which of the following is the correct sequence of events in the cardiac cycle?",
                    options: ["A) Atrial systole ‚Üí Ventricular systole ‚Üí Joint diastole", "B) Ventricular systole ‚Üí Atrial systole ‚Üí Joint diastole", "C) Joint diastole ‚Üí Atrial systole ‚Üí Ventricular systole", "D) Atrial systole ‚Üí Joint diastole ‚Üí Ventricular systole"],
                    correct: "A",
                    year: "2024",
                    subject: "Biology",
                    chapter: "Human Physiology",
                    explanation: "The cardiac cycle consists of three phases: Atrial systole (atria contract), Ventricular systole (ventricles contract), and Joint diastole (both chambers relax and fill with blood)."
                },
                {
                    question: "The photoelectric effect was explained by Einstein using which concept?",
                    options: ["A) Wave nature of light", "B) Particle nature of light", "C) Dual nature of light", "D) Electromagnetic theory"],
                    correct: "B",
                    year: "2023",
                    subject: "Physics",
                    chapter: "Modern Physics",
                    explanation: "Einstein explained the photoelectric effect by proposing that light consists of discrete packets of energy called photons, demonstrating the particle nature of light."
                },
                {
                    question: "Which of the following compounds shows geometrical isomerism?",
                    options: ["A) CH‚ÇÉ-CH‚ÇÇ-CH‚ÇÇ-CH‚ÇÉ", "B) CH‚ÇÉ-CH=CH-CH‚ÇÉ", "C) CH‚ÇÉ-CH‚ÇÇ-OH", "D) CH‚ÇÉ-CO-CH‚ÇÉ"],
                    correct: "B",
                    year: "2022",
                    subject: "Chemistry",
                    chapter: "Organic Chemistry",
                    explanation: "But-2-ene (CH‚ÇÉ-CH=CH-CH‚ÇÉ) shows geometrical isomerism due to restricted rotation around the C=C double bond, existing as cis and trans isomers."
                },
                {
                    question: "The process of translation in protein synthesis occurs in:",
                    options: ["A) Nucleus", "B) Ribosomes", "C) Mitochondria", "D) Golgi apparatus"],
                    correct: "B",
                    year: "2022",
                    subject: "Biology",
                    chapter: "Molecular Biology",
                    explanation: "Translation is the process where mRNA is decoded by ribosomes to synthesize proteins. Ribosomes are the cellular machinery responsible for protein synthesis."
                },
                {
                    question: "The dimensional formula of angular momentum is:",
                    options: ["A) [ML¬≤T‚Åª¬π]", "B) [MLT‚Åª¬π]", "C) [ML¬≤T‚Åª¬≤]", "D) [MLT‚Åª¬≤]"],
                    correct: "A",
                    year: "2021",
                    subject: "Physics",
                    chapter: "Mechanics",
                    explanation: "Angular momentum = mvr = mass √ó velocity √ó radius. Dimensionally: [M][LT‚Åª¬π][L] = [ML¬≤T‚Åª¬π]"
                }
            ],
            JEE: [
                // 2025 Questions
                {
                    question: "The value of lim(x‚Üí0) (sin x - x)/(x¬≥) is:",
                    options: ["A) -1/6", "B) 0", "C) 1/6", "D) Does not exist"],
                    correct: "A",
                    year: "2025",
                    subject: "Mathematics",
                    chapter: "Calculus",
                    explanation: "Using Taylor series expansion: sin x = x - x¬≥/6 + x‚Åµ/120 - ... So (sin x - x)/x¬≥ = -1/6 + x¬≤/120 - ... As x‚Üí0, limit = -1/6"
                },
                {
                    question: "The magnetic field inside a solenoid carrying current I with n turns per unit length is:",
                    options: ["A) Œº‚ÇÄnI", "B) Œº‚ÇÄnI/2", "C) 2Œº‚ÇÄnI", "D) Œº‚ÇÄI/n"],
                    correct: "A",
                    year: "2025",
                    subject: "Physics",
                    chapter: "Magnetism",
                    explanation: "For a long solenoid, the magnetic field inside is uniform and given by B = Œº‚ÇÄnI, where Œº‚ÇÄ is permeability of free space, n is turns per unit length, and I is current."
                },
                {
                    question: "The rate of a first-order reaction is directly proportional to:",
                    options: ["A) Square of concentration", "B) Concentration", "C) Square root of concentration", "D) Inverse of concentration"],
                    correct: "B",
                    year: "2025",
                    subject: "Chemistry",
                    chapter: "Chemical Kinetics",
                    explanation: "For a first-order reaction, rate = k[A]¬π, so the rate is directly proportional to the first power of concentration."
                },
                
                // 2024 Questions
                {
                    question: "If f(x) = x¬≥ - 3x¬≤ + 2x - 1, then f'(1) equals:",
                    options: ["A) -1", "B) 0", "C) 1", "D) 2"],
                    correct: "A",
                    year: "2024",
                    subject: "Mathematics",
                    chapter: "Calculus",
                    explanation: "f'(x) = 3x¬≤ - 6x + 2. Substituting x = 1: f'(1) = 3(1)¬≤ - 6(1) + 2 = 3 - 6 + 2 = -1."
                },
                {
                    question: "The hybridization of carbon atoms in benzene is:",
                    options: ["A) sp", "B) sp¬≤", "C) sp¬≥", "D) sp¬≥d"],
                    correct: "B",
                    year: "2023",
                    subject: "Chemistry",
                    chapter: "Organic Chemistry",
                    explanation: "In benzene, each carbon atom is bonded to two other carbon atoms and one hydrogen atom, with one electron in a p-orbital participating in the delocalized œÄ system. This corresponds to sp¬≤ hybridization."
                },
                {
                    question: "The work done in moving a charge q through a potential difference V is:",
                    options: ["A) qV", "B) q/V", "C) V/q", "D) qV¬≤"],
                    correct: "A",
                    year: "2022",
                    subject: "Physics",
                    chapter: "Electricity",
                    explanation: "Work done = Charge √ó Potential difference = qV. This is the fundamental relationship between work, charge, and potential difference."
                },
                {
                    question: "The number of solutions of the equation sin x = x/2 in the interval [-2œÄ, 2œÄ] is:",
                    options: ["A) 3", "B) 5", "C) 7", "D) 9"],
                    correct: "B",
                    year: "2022",
                    subject: "Mathematics",
                    chapter: "Trigonometry",
                    explanation: "The equation sin x = x/2 has solutions where the sine curve intersects the line y = x/2. In the given interval, there are 5 intersection points."
                },
                {
                    question: "Which of the following is the strongest acid?",
                    options: ["A) HF", "B) HCl", "C) HBr", "D) HI"],
                    correct: "D",
                    year: "2021",
                    subject: "Chemistry",
                    chapter: "Inorganic Chemistry",
                    explanation: "Among halogen acids, acid strength increases down the group: HF < HCl < HBr < HI. This is due to decreasing bond strength and increasing ease of H‚Å∫ release."
                }
            ],
            IIT: [
                // 2025 Questions
                {
                    question: "The number of real solutions of the equation e^x = x¬≤ is:",
                    options: ["A) 0", "B) 1", "C) 2", "D) 3"],
                    correct: "C",
                    year: "2025",
                    subject: "Mathematics",
                    chapter: "Calculus",
                    explanation: "By graphical analysis or numerical methods, the exponential function e^x intersects the parabola x¬≤ at exactly two points, giving two real solutions."
                },
                {
                    question: "The electric field due to an infinite line charge at distance r is proportional to:",
                    options: ["A) 1/r", "B) 1/r¬≤", "C) r", "D) r¬≤"],
                    correct: "A",
                    year: "2025",
                    subject: "Physics",
                    chapter: "Electrostatics",
                    explanation: "For an infinite line charge with linear charge density Œª, the electric field at distance r is E = Œª/(2œÄŒµ‚ÇÄr), which is proportional to 1/r."
                },
                {
                    question: "The coordination number of Ni¬≤‚Å∫ in [Ni(CN)‚ÇÑ]¬≤‚Åª is:",
                    options: ["A) 2", "B) 4", "C) 6", "D) 8"],
                    correct: "B",
                    year: "2025",
                    subject: "Chemistry",
                    chapter: "Coordination Compounds",
                    explanation: "In the complex [Ni(CN)‚ÇÑ]¬≤‚Åª, the central Ni¬≤‚Å∫ ion is surrounded by 4 CN‚Åª ligands, giving it a coordination number of 4."
                },
                
                // 2024 Questions
                {
                    question: "The value of ‚à´‚ÇÄ^œÄ x sin x dx is:",
                    options: ["A) œÄ", "B) 2œÄ", "C) œÄ/2", "D) 0"],
                    correct: "A",
                    year: "2024",
                    subject: "Mathematics",
                    chapter: "Calculus",
                    explanation: "Using integration by parts: ‚à´x sin x dx = -x cos x + ‚à´cos x dx = -x cos x + sin x. Evaluating from 0 to œÄ: [-œÄ cos œÄ + sin œÄ] - [0 cos 0 + sin 0] = œÄ"
                },
                {
                    question: "The magnetic field at the center of a circular current loop is:",
                    options: ["A) Œº‚ÇÄI/2R", "B) Œº‚ÇÄI/4R", "C) Œº‚ÇÄI/R", "D) 2Œº‚ÇÄI/R"],
                    correct: "A",
                    year: "2023",
                    subject: "Physics",
                    chapter: "Magnetism",
                    explanation: "The magnetic field at the center of a circular loop carrying current I with radius R is B = Œº‚ÇÄI/2R, where Œº‚ÇÄ is the permeability of free space."
                },
                {
                    question: "The IUPAC name of CH‚ÇÉ-CH(CH‚ÇÉ)-CH‚ÇÇ-COOH is:",
                    options: ["A) 3-methylbutanoic acid", "B) 2-methylbutanoic acid", "C) 3-methylpropanoic acid", "D) 2-methylpropanoic acid"],
                    correct: "A",
                    year: "2022",
                    subject: "Chemistry",
                    chapter: "Organic Chemistry",
                    explanation: "The longest carbon chain has 4 carbons with COOH group, making it butanoic acid. The methyl group is at position 3 from the COOH carbon."
                },
                {
                    question: "The eigenvalues of the matrix [[2,1],[0,3]] are:",
                    options: ["A) 2, 3", "B) 1, 3", "C) 2, 1", "D) 0, 5"],
                    correct: "A",
                    year: "2022",
                    subject: "Mathematics",
                    chapter: "Linear Algebra",
                    explanation: "For an upper triangular matrix, the eigenvalues are the diagonal elements. Therefore, the eigenvalues are 2 and 3."
                },
                {
                    question: "The de Broglie wavelength of an electron accelerated through a potential V is:",
                    options: ["A) h/‚àö(2meV)", "B) h/‚àö(meV)", "C) h‚àö(2meV)", "D) h/‚àö(2mV)"],
                    correct: "A",
                    year: "2021",
                    subject: "Physics",
                    chapter: "Modern Physics",
                    explanation: "de Broglie wavelength Œª = h/p. For an electron accelerated through potential V: KE = eV = p¬≤/2m, so p = ‚àö(2meV). Therefore, Œª = h/‚àö(2meV)."
                }
            ],
            KCET: [
                // 2025 Questions
                {
                    question: "The dimensional formula for impulse is:",
                    options: ["A) [MLT‚Åª¬π]", "B) [MLT‚Åª¬≤]", "C) [ML¬≤T‚Åª¬π]", "D) [ML¬≤T‚Åª¬≤]"],
                    correct: "A",
                    year: "2025",
                    subject: "Physics",
                    chapter: "Mechanics",
                    explanation: "Impulse = Force √ó Time = [MLT‚Åª¬≤] √ó [T] = [MLT‚Åª¬π]. It has the same dimensions as momentum."
                },
                {
                    question: "The number of œÉ and œÄ bonds in ethyne (C‚ÇÇH‚ÇÇ) is:",
                    options: ["A) 3œÉ, 2œÄ", "B) 2œÉ, 3œÄ", "C) 4œÉ, 1œÄ", "D) 1œÉ, 4œÄ"],
                    correct: "A",
                    year: "2025",
                    subject: "Chemistry",
                    chapter: "Chemical Bonding",
                    explanation: "Ethyne (H-C‚â°C-H) has: 2 C-H œÉ bonds, 1 C-C œÉ bond, and 2 C-C œÄ bonds. Total: 3œÉ and 2œÄ bonds."
                },
                {
                    question: "If log‚ÇÇ x = 3, then x equals:",
                    options: ["A) 6", "B) 8", "C) 9", "D) 12"],
                    correct: "B",
                    year: "2025",
                    subject: "Mathematics",
                    chapter: "Logarithms",
                    explanation: "If log‚ÇÇ x = 3, then x = 2¬≥ = 8. This follows from the definition of logarithm."
                },
                
                // 2024 Questions
                {
                    question: "The SI unit of electric field is:",
                    options: ["A) N/C", "B) C/N", "C) V/m", "D) Both A and C"],
                    correct: "D",
                    year: "2024",
                    subject: "Physics",
                    chapter: "Electricity",
                    explanation: "Electric field can be expressed as force per unit charge (N/C) or as potential gradient (V/m). Both are equivalent: 1 N/C = 1 V/m."
                },
                {
                    question: "The molecular formula of glucose is:",
                    options: ["A) C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ", "B) C‚ÇÜH‚ÇÅ‚ÇÄO‚ÇÖ", "C) C‚ÇÖH‚ÇÅ‚ÇÄO‚ÇÖ", "D) C‚ÇÜH‚ÇÅ‚ÇÑO‚ÇÜ"],
                    correct: "A",
                    year: "2023",
                    subject: "Chemistry",
                    chapter: "Organic Chemistry",
                    explanation: "Glucose is a simple sugar with the molecular formula C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ. It is the most important monosaccharide in biology."
                },
                {
                    question: "The area of a triangle with vertices at (0,0), (3,0), and (0,4) is:",
                    options: ["A) 6", "B) 12", "C) 7", "D) 5"],
                    correct: "A",
                    year: "2022",
                    subject: "Mathematics",
                    chapter: "Coordinate Geometry",
                    explanation: "This is a right triangle with base = 3 and height = 4. Area = (1/2) √ó base √ó height = (1/2) √ó 3 √ó 4 = 6 square units."
                },
                {
                    question: "Photosynthesis occurs in which part of the plant cell?",
                    options: ["A) Nucleus", "B) Chloroplast", "C) Mitochondria", "D) Ribosome"],
                    correct: "B",
                    year: "2022",
                    subject: "Biology",
                    chapter: "Plant Physiology",
                    explanation: "Photosynthesis occurs in chloroplasts, which contain chlorophyll and other pigments necessary for capturing light energy and converting CO‚ÇÇ and water into glucose."
                },
                {
                    question: "The pH of pure water at 25¬∞C is:",
                    options: ["A) 0", "B) 7", "C) 14", "D) 1"],
                    correct: "B",
                    year: "2021",
                    subject: "Chemistry",
                    chapter: "Acids and Bases",
                    explanation: "Pure water at 25¬∞C has a pH of 7, which is neutral. This is because [H‚Å∫] = [OH‚Åª] = 10‚Åª‚Å∑ M, and pH = -log[H‚Å∫] = 7."
                }
            ]
        };

        // Expanded Question Bank - Multiple questions per chapter
        const questionBank = {
            NEET: {
                Physics: {
                    Mechanics: [
                        {
                            question: "A ball is thrown vertically upward with velocity 20 m/s. What is the maximum height? (g = 10 m/s¬≤)",
                            options: ["A) 10 m", "B) 20 m", "C) 30 m", "D) 40 m"],
                            correct: "B",
                            explanation: "Using the kinematic equation v¬≤ = u¬≤ + 2as, where final velocity v = 0 at maximum height, initial velocity u = 20 m/s, and acceleration a = -g = -10 m/s¬≤. Solving: 0 = (20)¬≤ + 2(-10)s, which gives s = 400/20 = 20 m."
                        },
                        {
                            question: "A car accelerates from rest at 2 m/s¬≤. What is its velocity after 5 seconds?",
                            options: ["A) 5 m/s", "B) 10 m/s", "C) 15 m/s", "D) 20 m/s"],
                            correct: "B",
                            explanation: "Using the equation v = u + at, where initial velocity u = 0 (starts from rest), acceleration a = 2 m/s¬≤, and time t = 5 s. Therefore, v = 0 + (2)(5) = 10 m/s."
                        },
                        {
                            question: "The SI unit of force is:",
                            options: ["A) Joule", "B) Watt", "C) Newton", "D) Pascal"],
                            correct: "C",
                            explanation: "The Newton (N) is the SI unit of force, named after Sir Isaac Newton. It is defined as the force required to accelerate a mass of 1 kilogram at 1 meter per second squared (1 N = 1 kg‚ãÖm/s¬≤)."
                        },
                        {
                            question: "If a body moves with constant velocity, its acceleration is:",
                            options: ["A) Constant", "B) Zero", "C) Increasing", "D) Decreasing"],
                            correct: "B",
                            explanation: "Acceleration is the rate of change of velocity. If velocity is constant (not changing), then the rate of change is zero, meaning acceleration = 0. This follows from Newton's first law of motion."
                        },
                        {
                            question: "The momentum of a body is the product of:",
                            options: ["A) Mass and velocity", "B) Mass and acceleration", "C) Force and time", "D) Force and distance"],
                            correct: "A",
                            explanation: "Momentum (p) is defined as the product of mass (m) and velocity (v): p = mv. It is a vector quantity that represents the quantity of motion of a moving body."
                        },
                        {
                            question: "Newton's third law states:",
                            options: ["A) F = ma", "B) Every action has equal and opposite reaction", "C) Law of inertia", "D) Conservation of energy"],
                            correct: "B"
                        },
                        {
                            question: "The acceleration due to gravity on Earth is approximately:",
                            options: ["A) 8.8 m/s¬≤", "B) 9.8 m/s¬≤", "C) 10.8 m/s¬≤", "D) 11.8 m/s¬≤"],
                            correct: "B"
                        },
                        {
                            question: "A projectile motion has:",
                            options: ["A) Constant horizontal velocity", "B) Constant vertical velocity", "C) Constant acceleration", "D) Both A and C"],
                            correct: "D"
                        },
                        {
                            question: "The work done by a force is maximum when the angle between force and displacement is:",
                            options: ["A) 0¬∞", "B) 45¬∞", "C) 90¬∞", "D) 180¬∞"],
                            correct: "A"
                        },
                        {
                            question: "Power is defined as:",
                            options: ["A) Work/Time", "B) Force √ó Distance", "C) Mass √ó Acceleration", "D) Energy/Mass"],
                            correct: "A"
                        },
                        {
                            question: "The kinetic energy of a moving body depends on:",
                            options: ["A) Mass only", "B) Velocity only", "C) Both mass and velocity", "D) Neither mass nor velocity"],
                            correct: "C"
                        },
                        {
                            question: "In circular motion, the centripetal force is directed:",
                            options: ["A) Tangentially", "B) Towards the center", "C) Away from center", "D) Vertically upward"],
                            correct: "B"
                        },
                        {
                            question: "The coefficient of friction is:",
                            options: ["A) Always greater than 1", "B) Always less than 1", "C) Can be greater or less than 1", "D) Always equal to 1"],
                            correct: "C"
                        },
                        {
                            question: "Simple harmonic motion is characterized by:",
                            options: ["A) Constant velocity", "B) Constant acceleration", "C) Restoring force proportional to displacement", "D) Constant force"],
                            correct: "C"
                        },
                        {
                            question: "The time period of a simple pendulum depends on:",
                            options: ["A) Mass of bob", "B) Length of string", "C) Amplitude", "D) All of these"],
                            correct: "B"
                        },
                        {
                            question: "Escape velocity from Earth is approximately:",
                            options: ["A) 7.9 km/s", "B) 11.2 km/s", "C) 15.5 km/s", "D) 20.1 km/s"],
                            correct: "B"
                        },
                        {
                            question: "The angular momentum of a rotating body is:",
                            options: ["A) I √ó œâ", "B) m √ó v", "C) F √ó r", "D) œÑ √ó t"],
                            correct: "A"
                        },
                        {
                            question: "Torque is the rotational equivalent of:",
                            options: ["A) Mass", "B) Velocity", "C) Force", "D) Acceleration"],
                            correct: "C"
                        },
                        {
                            question: "The moment of inertia depends on:",
                            options: ["A) Mass distribution", "B) Axis of rotation", "C) Both A and B", "D) Neither A nor B"],
                            correct: "C"
                        },
                        {
                            question: "Conservation of momentum applies when:",
                            options: ["A) External force is zero", "B) Internal forces are present", "C) System is isolated", "D) All of these"],
                            correct: "D"
                        },
                        {
                            question: "In an elastic collision:",
                            options: ["A) Momentum is conserved", "B) Kinetic energy is conserved", "C) Both A and B", "D) Neither A nor B"],
                            correct: "C"
                        },
                        {
                            question: "The center of mass of a system:",
                            options: ["A) Always lies within the system", "B) May lie outside the system", "C) Is always at the geometric center", "D) Depends on external forces"],
                            correct: "B"
                        },
                        {
                            question: "Hooke's law is valid for:",
                            options: ["A) All materials", "B) Elastic limit", "C) Plastic deformation", "D) Breaking point"],
                            correct: "B"
                        },
                        {
                            question: "Young's modulus is the ratio of:",
                            options: ["A) Stress to strain", "B) Strain to stress", "C) Force to area", "D) Length to change in length"],
                            correct: "A"
                        },
                        {
                            question: "Surface tension is due to:",
                            options: ["A) Cohesive forces", "B) Adhesive forces", "C) Gravitational forces", "D) Magnetic forces"],
                            correct: "A"
                        },
                        {
                            question: "Bernoulli's principle is based on:",
                            options: ["A) Conservation of mass", "B) Conservation of energy", "C) Conservation of momentum", "D) All of these"],
                            correct: "B"
                        },
                        {
                            question: "The terminal velocity of a falling object is reached when:",
                            options: ["A) Air resistance equals weight", "B) Acceleration becomes zero", "C) Velocity becomes constant", "D) All of these"],
                            correct: "D"
                        },
                        {
                            question: "Archimedes' principle states that buoyant force equals:",
                            options: ["A) Weight of object", "B) Weight of displaced fluid", "C) Volume of object", "D) Density of fluid"],
                            correct: "B"
                        },
                        {
                            question: "The pressure at a depth h in a fluid is:",
                            options: ["A) œÅgh", "B) œÅg/h", "C) œÅh/g", "D) gh/œÅ"],
                            correct: "A"
                        },
                        {
                            question: "In rotational motion, angular acceleration is:",
                            options: ["A) dœâ/dt", "B) dŒ∏/dt", "C) œâ¬≤r", "D) v/r"],
                            correct: "A"
                        },
                        {
                            question: "The relation between linear and angular velocity is:",
                            options: ["A) v = rœâ", "B) v = r/œâ", "C) v = œâ/r", "D) v = r + œâ"],
                            correct: "A"
                        },
                        {
                            question: "Gyroscopic effect is due to:",
                            options: ["A) Conservation of angular momentum", "B) Conservation of energy", "C) Conservation of mass", "D) Centrifugal force"],
                            correct: "A"
                        },
                        {
                            question: "The frequency of oscillation of a spring-mass system is:",
                            options: ["A) (1/2œÄ)‚àö(k/m)", "B) (1/2œÄ)‚àö(m/k)", "C) 2œÄ‚àö(k/m)", "D) 2œÄ‚àö(m/k)"],
                            correct: "A"
                        },
                        {
                            question: "Damped oscillations occur when:",
                            options: ["A) No external force", "B) Resistive force is present", "C) Driving force is applied", "D) System is isolated"],
                            correct: "B"
                        },
                        {
                            question: "Resonance occurs when:",
                            options: ["A) Driving frequency equals natural frequency", "B) Amplitude is maximum", "C) Energy transfer is maximum", "D) All of these"],
                            correct: "D"
                        },
                        {
                            question: "The phase difference between displacement and velocity in SHM is:",
                            options: ["A) 0¬∞", "B) 90¬∞", "C) 180¬∞", "D) 270¬∞"],
                            correct: "B"
                        },
                        {
                            question: "Wave speed depends on:",
                            options: ["A) Frequency", "B) Wavelength", "C) Medium properties", "D) Amplitude"],
                            correct: "C"
                        },
                        {
                            question: "Standing waves are formed by:",
                            options: ["A) Superposition of two waves", "B) Reflection of waves", "C) Interference", "D) All of these"],
                            correct: "D"
                        },
                        {
                            question: "Doppler effect occurs due to:",
                            options: ["A) Relative motion between source and observer", "B) Change in frequency", "C) Wave interference", "D) Medium properties"],
                            correct: "A"
                        },
                        {
                            question: "The speed of sound in air at room temperature is approximately:",
                            options: ["A) 300 m/s", "B) 330 m/s", "C) 340 m/s", "D) 350 m/s"],
                            correct: "C"
                        },
                        {
                            question: "Beats are produced when two waves have:",
                            options: ["A) Same frequency", "B) Slightly different frequencies", "C) Same amplitude", "D) Same phase"],
                            correct: "B"
                        },
                        {
                            question: "The intensity of sound is proportional to:",
                            options: ["A) Amplitude", "B) Square of amplitude", "C) Frequency", "D) Wavelength"],
                            correct: "B"
                        },
                        {
                            question: "Ultrasonic waves have frequency:",
                            options: ["A) Less than 20 Hz", "B) 20 Hz to 20 kHz", "C) Greater than 20 kHz", "D) Exactly 20 kHz"],
                            correct: "C"
                        },
                        {
                            question: "The principle of superposition states that:",
                            options: ["A) Waves add algebraically", "B) Waves multiply", "C) Waves cancel out", "D) Waves remain unchanged"],
                            correct: "A"
                        },
                        {
                            question: "Mechanical waves require:",
                            options: ["A) Medium for propagation", "B) No medium", "C) Electric field", "D) Magnetic field"],
                            correct: "A",
                            explanation: "Mechanical waves are waves that require a material medium to propagate. Examples include sound waves (need air, water, or solid materials), water waves (need water as medium), and seismic waves (need earth's crust). Unlike electromagnetic waves, mechanical waves cannot travel through vacuum."
                        },
                        {
                            question: "Transverse waves have:",
                            options: ["A) Particle motion parallel to wave direction", "B) Particle motion perpendicular to wave direction", "C) No particle motion", "D) Circular particle motion"],
                            correct: "B"
                        },
                        {
                            question: "Longitudinal waves have:",
                            options: ["A) Particle motion parallel to wave direction", "B) Particle motion perpendicular to wave direction", "C) No particle motion", "D) Random particle motion"],
                            correct: "A"
                        },
                        {
                            question: "The wavelength of a wave is the distance between:",
                            options: ["A) Two consecutive crests", "B) Crest and trough", "C) Two nodes", "D) Source and observer"],
                            correct: "A"
                        },
                        {
                            question: "The amplitude of a wave represents:",
                            options: ["A) Maximum displacement", "B) Wavelength", "C) Frequency", "D) Speed"],
                            correct: "A"
                        },
                        {
                            question: "Wave equation is given by:",
                            options: ["A) v = fŒª", "B) v = f/Œª", "C) v = Œª/f", "D) v = f + Œª"],
                            correct: "A"
                        },
                        {
                            question: "The period of a wave is:",
                            options: ["A) 1/frequency", "B) frequency", "C) wavelength", "D) amplitude"],
                            correct: "A"
                        }
                    ],
                    Thermodynamics: {
                        question: "The SI unit of temperature is:",
                        options: ["A) Celsius", "B) Fahrenheit", "C) Kelvin", "D) Rankine"],
                        correct: "C"
                    },
                    Optics: {
                        question: "The speed of light in vacuum is:",
                        options: ["A) 3 √ó 10‚Å∂ m/s", "B) 3 √ó 10‚Å∑ m/s", "C) 3 √ó 10‚Å∏ m/s", "D) 3 √ó 10‚Åπ m/s"],
                        correct: "C"
                    },
                    Electricity: {
                        question: "The SI unit of electric current is:",
                        options: ["A) Coulomb", "B) Ampere", "C) Volt", "D) Ohm"],
                        correct: "B"
                    }
                },
                Chemistry: {
                    "Organic Chemistry": {
                        question: "The general formula for alkanes is:",
                        options: ["A) C‚ÇôH‚ÇÇ‚Çô", "B) C‚ÇôH‚ÇÇ‚Çô‚Çä‚ÇÇ", "C) C‚ÇôH‚ÇÇ‚Çô‚Çã‚ÇÇ", "D) C‚ÇôH‚ÇÇ‚Çô‚Çã‚ÇÜ"],
                        correct: "B",
                        explanation: "Alkanes are saturated hydrocarbons with the general formula C‚ÇôH‚ÇÇ‚Çô‚Çä‚ÇÇ. Examples: Methane CH‚ÇÑ (n=1, so 2(1)+2 = 4 hydrogens), Ethane C‚ÇÇH‚ÇÜ (n=2, so 2(2)+2 = 6 hydrogens). They are called saturated because they contain only single bonds between carbon atoms."
                    },
                    "Inorganic Chemistry": {
                        question: "The atomic number of hydrogen is:",
                        options: ["A) 0", "B) 1", "C) 2", "D) 3"],
                        correct: "B"
                    },
                    "Physical Chemistry": {
                        question: "Avogadro's number is approximately:",
                        options: ["A) 6.02 √ó 10¬≤¬π", "B) 6.02 √ó 10¬≤¬≤", "C) 6.02 √ó 10¬≤¬≥", "D) 6.02 √ó 10¬≤‚Å¥"],
                        correct: "C",
                        explanation: "Avogadro's number is approximately 6.02 √ó 10¬≤¬≥. This represents the number of atoms in 12 grams of carbon-12, the number of particles in one mole of any substance, and is a fundamental constant in chemistry used to convert between atomic scale and macroscopic scale."
                    },
                    "Atomic Structure": {
                        question: "An atom consists of:",
                        options: ["A) Only protons", "B) Protons and neutrons", "C) Protons, neutrons and electrons", "D) Only electrons"],
                        correct: "C"
                    }
                },
                Biology: {
                    "Cell Biology": {
                        question: "The basic unit of life is:",
                        options: ["A) Tissue", "B) Organ", "C) Cell", "D) Organism"],
                        correct: "C",
                        explanation: "The cell is the basic unit of life. All living organisms are made of one or more cells, cells are the smallest units that can carry out all life processes, and they can exist as single-celled organisms or as part of multicellular organisms. This is a fundamental principle of cell theory."
                    },
                    Genetics: {
                        question: "Genes are made up of:",
                        options: ["A) Proteins", "B) DNA", "C) RNA", "D) Lipids"],
                        correct: "B",
                        explanation: "Genes are made up of DNA (Deoxyribonucleic Acid). DNA contains the genetic instructions for all living organisms, is composed of four nucleotide bases (A, T, G, C), forms a double helix structure, and stores hereditary information that is passed from parents to offspring."
                    },
                    Ecology: {
                        question: "Ecology is the study of:",
                        options: ["A) Animals", "B) Plants", "C) Environment", "D) Organisms and environment"],
                        correct: "D"
                    },
                    "Human Physiology": {
                        question: "The human heart has how many chambers?",
                        options: ["A) 2", "B) 3", "C) 4", "D) 5"],
                        correct: "C"
                    }
                }
            },
            JEE: {
                Physics: {
                    Mechanics: {
                        question: "Newton's first law is also known as:",
                        options: ["A) Law of inertia", "B) Law of acceleration", "C) Law of action-reaction", "D) Law of gravitation"],
                        correct: "A"
                    },
                    Thermodynamics: {
                        question: "Zeroth law of thermodynamics deals with:",
                        options: ["A) Energy", "B) Entropy", "C) Temperature", "D) Pressure"],
                        correct: "C"
                    },
                    Optics: {
                        question: "Light is:",
                        options: ["A) Wave", "B) Particle", "C) Both wave and particle", "D) Neither"],
                        correct: "C"
                    },
                    Electricity: {
                        question: "Electric field is:",
                        options: ["A) Scalar", "B) Vector", "C) Tensor", "D) Dimensionless"],
                        correct: "B"
                    }
                },
                Chemistry: {
                    "Organic Chemistry": {
                        question: "Hybridization of carbon in methane is:",
                        options: ["A) sp", "B) sp¬≤", "C) sp¬≥", "D) sp¬≥d"],
                        correct: "C"
                    },
                    "Inorganic Chemistry": {
                        question: "Periodic table has how many periods?",
                        options: ["A) 6", "B) 7", "C) 8", "D) 9"],
                        correct: "B"
                    },
                    "Physical Chemistry": {
                        question: "Molarity is defined as:",
                        options: ["A) Moles/kg solvent", "B) Moles/L solution", "C) Moles/L solvent", "D) Moles/kg solution"],
                        correct: "B"
                    },
                    "Atomic Structure": {
                        question: "Rutherford's experiment used:",
                        options: ["A) Œ±-particles", "B) Œ≤-particles", "C) Œ≥-rays", "D) X-rays"],
                        correct: "A"
                    }
                },
                Mathematics: {
                    Calculus: {
                        question: "Derivative of x¬≤ is:",
                        options: ["A) x", "B) 2x", "C) x¬≤/2", "D) 2x¬≤"],
                        correct: "B"
                    },
                    Algebra: {
                        question: "If x + y = 5 and x - y = 1, then x equals:",
                        options: ["A) 2", "B) 3", "C) 4", "D) 5"],
                        correct: "B"
                    },
                    Geometry: {
                        question: "Sum of angles in a triangle is:",
                        options: ["A) 90¬∞", "B) 180¬∞", "C) 270¬∞", "D) 360¬∞"],
                        correct: "B"
                    },
                    Trigonometry: {
                        question: "sin¬≤Œ∏ + cos¬≤Œ∏ equals:",
                        options: ["A) 0", "B) 1", "C) 2", "D) sin2Œ∏"],
                        correct: "B"
                    }
                }
            },
            IIT: {
                Physics: {
                    Mechanics: {
                        question: "For a particle in circular motion, which quantity remains constant?",
                        options: ["A) Velocity", "B) Acceleration", "C) Speed", "D) Angular velocity"],
                        correct: "C"
                    },
                    Thermodynamics: {
                        question: "First law of thermodynamics is:",
                        options: ["A) Energy conservation", "B) Entropy increase", "C) Temperature equilibrium", "D) Pressure equilibrium"],
                        correct: "A"
                    },
                    Optics: {
                        question: "Huygens' principle explains:",
                        options: ["A) Reflection", "B) Refraction", "C) Diffraction", "D) All of these"],
                        correct: "D"
                    },
                    Electricity: {
                        question: "Gauss's law relates electric flux to:",
                        options: ["A) Electric field", "B) Electric charge", "C) Electric potential", "D) Electric current"],
                        correct: "B"
                    }
                },
                Chemistry: {
                    "Organic Chemistry": {
                        question: "Carbocation stability order is:",
                        options: ["A) 1¬∞ > 2¬∞ > 3¬∞", "B) 3¬∞ > 2¬∞ > 1¬∞", "C) 2¬∞ > 3¬∞ > 1¬∞", "D) All equal"],
                        correct: "B"
                    },
                    "Inorganic Chemistry": {
                        question: "Effective nuclear charge increases:",
                        options: ["A) Down the group", "B) Across the period", "C) Both", "D) Neither"],
                        correct: "B"
                    },
                    "Physical Chemistry": {
                        question: "Colligative properties depend on:",
                        options: ["A) Nature of solute", "B) Number of particles", "C) Both A and B", "D) Temperature only"],
                        correct: "B"
                    },
                    "Atomic Structure": {
                        question: "Spin-orbit coupling leads to:",
                        options: ["A) Fine structure", "B) Hyperfine structure", "C) Zeeman effect", "D) Stark effect"],
                        correct: "A"
                    }
                },
                Mathematics: {
                    Calculus: {
                        question: "Rolle's theorem requires:",
                        options: ["A) Continuity", "B) Differentiability", "C) f(a) = f(b)", "D) All of these"],
                        correct: "D"
                    },
                    Algebra: {
                        question: "A group must satisfy:",
                        options: ["A) Closure", "B) Associativity", "C) Identity and inverse", "D) All of these"],
                        correct: "D"
                    },
                    Geometry: {
                        question: "Euclidean geometry is based on:",
                        options: ["A) 5 postulates", "B) 10 postulates", "C) 3 postulates", "D) 7 postulates"],
                        correct: "A"
                    },
                    Trigonometry: {
                        question: "sin‚Åª¬πx + cos‚Åª¬πx equals:",
                        options: ["A) œÄ/4", "B) œÄ/2", "C) œÄ", "D) 2œÄ"],
                        correct: "B"
                    }
                }
            },
            KCET: {
                Physics: {
                    Mechanics: {
                        question: "SI unit of velocity is:",
                        options: ["A) m/s", "B) m/s¬≤", "C) km/h", "D) cm/s"],
                        correct: "A"
                    },
                    Thermodynamics: {
                        question: "Temperature is a measure of:",
                        options: ["A) Heat", "B) Internal energy", "C) Average kinetic energy", "D) Total energy"],
                        correct: "C"
                    },
                    Optics: {
                        question: "Light travels fastest in:",
                        options: ["A) Air", "B) Water", "C) Glass", "D) Vacuum"],
                        correct: "D"
                    },
                    Electricity: {
                        question: "Ohm's law states:",
                        options: ["A) V = IR", "B) I = VR", "C) R = VI", "D) P = VI"],
                        correct: "A"
                    }
                },
                Chemistry: {
                    "Organic Chemistry": {
                        question: "Methane has how many hydrogen atoms?",
                        options: ["A) 2", "B) 3", "C) 4", "D) 6"],
                        correct: "C"
                    },
                    "Inorganic Chemistry": {
                        question: "Which is the most abundant gas in atmosphere?",
                        options: ["A) Oxygen", "B) Carbon dioxide", "C) Nitrogen", "D) Argon"],
                        correct: "C"
                    },
                    "Physical Chemistry": {
                        question: "One mole of any gas at STP occupies:",
                        options: ["A) 22.4 L", "B) 24.4 L", "C) 20.4 L", "D) 26.4 L"],
                        correct: "A"
                    },
                    "Atomic Structure": {
                        question: "The charge on electron is:",
                        options: ["A) +1.6 √ó 10‚Åª¬π‚Åπ C", "B) -1.6 √ó 10‚Åª¬π‚Åπ C", "C) +1.6 √ó 10¬π‚Åπ C", "D) -1.6 √ó 10¬π‚Åπ C"],
                        correct: "B"
                    }
                },
                Mathematics: {
                    Calculus: {
                        question: "‚à´x dx equals:",
                        options: ["A) x¬≤", "B) x¬≤/2", "C) x¬≤/2 + C", "D) 2x"],
                        correct: "C"
                    },
                    Algebra: {
                        question: "The quadratic formula is:",
                        options: ["A) x = (-b ¬± ‚àö(b¬≤-4ac))/2a", "B) x = (-b ¬± ‚àö(b¬≤+4ac))/2a", "C) x = (b ¬± ‚àö(b¬≤-4ac))/2a", "D) x = (-b ¬± ‚àö(b¬≤-4ac))/a"],
                        correct: "A"
                    },
                    Geometry: {
                        question: "Area of circle with radius r is:",
                        options: ["A) œÄr", "B) 2œÄr", "C) œÄr¬≤", "D) 2œÄr¬≤"],
                        correct: "C"
                    },
                    Trigonometry: {
                        question: "tan 45¬∞ equals:",
                        options: ["A) 0", "B) 1/2", "C) 1", "D) ‚àö3"],
                        correct: "C"
                    }
                }
            }
        };

        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionName).classList.remove('hidden');
            
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if (isDarkMode) {
                    btn.classList.remove('bg-gradient-to-r', 'from-blue-600', 'to-purple-600', 'text-white');
                    btn.classList.add('text-gray-300', 'hover:bg-slate-700', 'hover:text-white');
                } else {
                    btn.classList.remove('bg-primary', 'text-white');
                    btn.classList.add('text-gray-700', 'hover:bg-gray-100');
                }
            });
            
            // Find and highlight the clicked button
            const clickedBtn = document.querySelector(`button[onclick="showSection('${sectionName}')"]`);
            if (clickedBtn) {
                if (isDarkMode) {
                    clickedBtn.classList.add('bg-gradient-to-r', 'from-blue-600', 'to-purple-600', 'text-white');
                    clickedBtn.classList.remove('text-gray-300', 'hover:bg-slate-700', 'hover:text-white');
                } else {
                    clickedBtn.classList.add('bg-primary', 'text-white');
                    clickedBtn.classList.remove('text-gray-700', 'hover:bg-gray-100');
                }
            }
        }

        function selectExam(exam) {
            selectedExam = exam;
            
            // Update third subject based on exam
            const thirdSubjectTitle = document.getElementById('thirdSubjectTitle');
            const thirdSubjectChapters = document.getElementById('thirdSubjectChapters');
            
            if (exam === 'NEET') {
                thirdSubjectTitle.innerHTML = `
                    <span class="w-6 h-6 bg-green-100 rounded mr-2 flex items-center justify-center">
                        <span class="text-green-600 text-sm">üß¨</span>
                    </span>
                    Biology
                `;
                thirdSubjectChapters.innerHTML = `
                    <!-- Class 11 Biology -->

    <!-- Unit 1: Diversity of Living Organisms -->
    <button onclick="selectChapter('Biology', 'The Living World')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: The Living World</button>
    <button onclick="selectChapter('Biology', 'Biological Classification')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 2: Biological Classification</button>
    <button onclick="selectChapter('Biology', 'Plant Kingdom')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 3: Plant Kingdom</button>
    <button onclick="selectChapter('Biology', 'Animal Kingdom')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 4: Animal Kingdom</button>

    <!-- Unit 2: Structural Organisation in Animals and Plants -->
    <button onclick="selectChapter('Biology', 'Morphology of Flowering Plants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 5: Morphology of Flowering Plants</button>
    <button onclick="selectChapter('Biology', 'Anatomy of Flowering Plants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 6: Anatomy of Flowering Plants</button>
    <button onclick="selectChapter('Biology', 'Structural Organisation in Animals')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 7: Structural Organisation in Animals</button>

    <!-- Unit 3: Cell Structure and Function -->
    <button onclick="selectChapter('Biology', 'Cell - The Unit of Life')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 8: Cell - The Unit of Life</button>
    <button onclick="selectChapter('Biology', 'Biomolecules')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 9: Biomolecules</button>
    <button onclick="selectChapter('Biology', 'Cell Cycle and Cell Division')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 10: Cell Cycle and Cell Division</button>

    <!-- Unit 4: Plant Physiology -->
    <button onclick="selectChapter('Biology', 'Transport in Plants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 11: Transport in Plants</button>
    <button onclick="selectChapter('Biology', 'Mineral Nutrition')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 12: Mineral Nutrition</button>
    <button onclick="selectChapter('Biology', 'Photosynthesis in Higher Plants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 13: Photosynthesis in Higher Plants</button>
    <button onclick="selectChapter('Biology', 'Respiration in Plants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 14: Respiration in Plants</button>
    <button onclick="selectChapter('Biology', 'Plant Growth and Development')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 15: Plant Growth and Development</button>

    <!-- Unit 5: Human Physiology -->
    <button onclick="selectChapter('Biology', 'Digestion and Absorption')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 16: Digestion and Absorption</button>
    <button onclick="selectChapter('Biology', 'Breathing and Exchange of Gases')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 17: Breathing and Exchange of Gases</button>
    <button onclick="selectChapter('Biology', 'Body Fluids and Circulation')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 18: Body Fluids and Circulation</button>
    <button onclick="selectChapter('Biology', 'Excretory Products and Their Elimination')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 19: Excretory Products and Their Elimination</button>
    <button onclick="selectChapter('Biology', 'Locomotion and Movement')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 20: Locomotion and Movement</button>
    <button onclick="selectChapter('Biology', 'Neural Control and Coordination')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 21: Neural Control and Coordination</button>
    <button onclick="selectChapter('Biology', 'Chemical Coordination and Integration')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 22: Chemical Coordination and Integration</button>

    <!-- Class 12 Biology -->

    <!-- Unit 6: Reproduction -->
    <button onclick="selectChapter('Biology', 'Reproduction in Organisms')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: Reproduction in Organisms</button>
    <button onclick="selectChapter('Biology', 'Sexual Reproduction in Flowering Plants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 2: Sexual Reproduction in Flowering Plants</button>
    <button onclick="selectChapter('Biology', 'Human Reproduction')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 3: Human Reproduction</button>
    <button onclick="selectChapter('Biology', 'Reproductive Health')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 4: Reproductive Health</button>

    <!-- Unit 7: Genetics and Evolution -->
    <button onclick="selectChapter('Biology', 'Principles of Inheritance and Variation')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 5: Principles of Inheritance and Variation</button>
    <button onclick="selectChapter('Biology', 'Molecular Basis of Inheritance')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 6: Molecular Basis of Inheritance</button>
    <button onclick="selectChapter('Biology', 'Evolution')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 7: Evolution</button>

    <!-- Unit 8: Biology and Human Welfare -->
    <button onclick="selectChapter('Biology', 'Human Health and Disease')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 8: Human Health and Disease</button>
    <button onclick="selectChapter('Biology', 'Strategies for Enhancement in Food Production')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 9: Strategies for Enhancement in Food Production</button>
    <button onclick="selectChapter('Biology', 'Microbes in Human Welfare')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 10: Microbes in Human Welfare</button>

    <!-- Unit 9: Biotechnology -->
    <button onclick="selectChapter('Biology', 'Biotechnology: Principles and Processes')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 11: Biotechnology: Principles and Processes</button>
    <button onclick="selectChapter('Biology', 'Biotechnology and Its Applications')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 12: Biotechnology and Its Applications</button>

    <!-- Unit 10: Ecology -->
    <button onclick="selectChapter('Biology', 'Organisms and Populations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 13: Organisms and Populations</button>
    <button onclick="selectChapter('Biology', 'Ecosystem')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 14: Ecosystem</button>
    <button onclick="selectChapter('Biology', 'Biodiversity and Conservation')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 15: Biodiversity and Conservation</button>
    <button onclick="selectChapter('Biology', 'Environmental Issues')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 16: Environmental Issues</button>

                `;
            } else {
                thirdSubjectTitle.innerHTML = `
                    <span class="w-6 h-6 bg-green-100 rounded mr-2 flex items-center justify-center">
                        <span class="text-green-600 text-sm">üìê</span>
                    </span>
                    Mathematics
                `;
                thirdSubjectChapters.innerHTML = `
                     <!-- Class 11 Mathematics -->

    <button onclick="selectChapter('Mathematics', 'Sets')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: Sets</button>
    <button onclick="selectChapter('Mathematics', 'Relations and Functions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 2: Relations and Functions</button>
    <button onclick="selectChapter('Mathematics', 'Trigonometric Functions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 3: Trigonometric Functions</button>
    <button onclick="selectChapter('Mathematics', 'Principle of Mathematical Induction')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 4: Principle of Mathematical Induction</button>
    <button onclick="selectChapter('Mathematics', 'Complex Numbers and Quadratic Equations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 5: Complex Numbers and Quadratic Equations</button>
    <button onclick="selectChapter('Mathematics', 'Linear Inequalities')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 6: Linear Inequalities</button>
    <button onclick="selectChapter('Mathematics', 'Permutations and Combinations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 7: Permutations and Combinations</button>
    <button onclick="selectChapter('Mathematics', 'Binomial Theorem')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 8: Binomial Theorem</button>
    <button onclick="selectChapter('Mathematics', 'Sequences and Series')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 9: Sequences and Series</button>
    <button onclick="selectChapter('Mathematics', 'Straight Lines')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 10: Straight Lines</button>
    <button onclick="selectChapter('Mathematics', 'Conic Sections')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 11: Conic Sections</button>
    <button onclick="selectChapter('Mathematics', 'Introduction to 3D Geometry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 12: Introduction to 3D Geometry</button>
    <button onclick="selectChapter('Mathematics', 'Limits and Derivatives')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 13: Limits and Derivatives</button>
    <button onclick="selectChapter('Mathematics', 'Mathematical Reasoning')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 14: Mathematical Reasoning</button>
    <button onclick="selectChapter('Mathematics', 'Statistics')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 15: Statistics</button>
    <button onclick="selectChapter('Mathematics', 'Probability')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 16: Probability</button>

    <!-- Class 12 Mathematics -->

    <button onclick="selectChapter('Mathematics', 'Relations and Functions (Class 12)')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 1: Relations and Functions (Class 12)</button>
    <button onclick="selectChapter('Mathematics', 'Inverse Trigonometric Functions')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 2: Inverse Trigonometric Functions</button>
    <button onclick="selectChapter('Mathematics', 'Matrices')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 3: Matrices</button>
    <button onclick="selectChapter('Mathematics', 'Determinants')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 4: Determinants</button>
    <button onclick="selectChapter('Mathematics', 'Continuity and Differentiability')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 5: Continuity and Differentiability</button>
    <button onclick="selectChapter('Mathematics', 'Application of Derivatives')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 6: Application of Derivatives</button>
    <button onclick="selectChapter('Mathematics', 'Integrals')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 7: Integrals</button>
    <button onclick="selectChapter('Mathematics', 'Application of Integrals')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 8: Application of Integrals</button>
    <button onclick="selectChapter('Mathematics', 'Differential Equations')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 9: Differential Equations</button>
    <button onclick="selectChapter('Mathematics', 'Vector Algebra')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 10: Vector Algebra</button>
    <button onclick="selectChapter('Mathematics', 'Three Dimensional Geometry')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 11: Three Dimensional Geometry</button>
    <button onclick="selectChapter('Mathematics', 'Linear Programming')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 12: Linear Programming</button>
    <button onclick="selectChapter('Mathematics', 'Probability (Class 12)')" class="chapter-btn w-full text-left px-3 py-2 rounded hover:bg-gray-100 text-sm">Chapter 13: Probability (Class 12)</button>

                `;
            }
            
            // Show subject selection
            document.getElementById('subjectSelection').classList.remove('hidden');
            
            // Highlight selected exam
            document.querySelectorAll('.exam-btn').forEach(btn => {
                btn.classList.remove('border-primary', 'bg-blue-50');
            });
            event.target.classList.add('border-primary', 'bg-blue-50');
        }

        function selectChapter(subject, chapter) {
            selectedSubject = subject;
            selectedChapter = chapter;
            
            // Update test details
            document.getElementById('testDetails').textContent = `Selected: ${selectedExam} > ${subject} > ${chapter}`;
            
            // Show start test section
            document.getElementById('startTestSection').classList.remove('hidden');
            
            // Highlight selected chapter
            document.querySelectorAll('.chapter-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
            });
            event.target.classList.add('bg-primary', 'text-white');
        }

        function startTest() {
            // Disable sidebar and mobile nav buttons during test
    document.querySelectorAll('.nav-btn, .nav-btn-mobile').forEach(btn => {
        btn.disabled = true;
        btn.classList.add('opacity-50', 'pointer-events-none');
    });
            // Get selected question count
            const selectedCount = document.querySelector('input[name="questionCount"]:checked').value;
            questionCount = parseInt(selectedCount);
            
            // Get all questions for selected chapter
            const allQuestions = questionBank[selectedExam][selectedSubject][selectedChapter];
            
            // Include previously wrong questions for adaptive learning
            const availableQuestions = [...allQuestions];
            if (wrongAnsweredQuestions.length > 0) {
                // Add more weight to previously wrong questions
                wrongAnsweredQuestions.forEach(wrongQ => {
                    const matchingQuestion = allQuestions.find(q => q.question === wrongQ.question);
                    if (matchingQuestion) {
                        availableQuestions.push(matchingQuestion); // Add duplicate for higher chance
                    }
                });
            }
            
            // Randomly select questions
            currentQuestions = getRandomQuestions(availableQuestions, questionCount);
            currentQuestionIndex = 0;
            userAnswers = new Array(questionCount).fill('');
            markedQuestions = new Array(questionCount).fill(false);
            questionStatus = new Array(questionCount).fill('not-visited');
            questionStatus[0] = 'current';
            testStartTime = Date.now();
            
            // Reset security variables
            tabSwitchWarnings = 0;
            
            // Show test interface
            document.getElementById('tests').classList.add('hidden');
            document.getElementById('testInterface').classList.remove('hidden');
            
            // Update test title
            document.getElementById('testTitle').textContent = `${selectedExam} - ${selectedSubject} - ${selectedChapter}`;
            document.getElementById('testInfo').textContent = `${questionCount} Questions ‚Ä¢ ${questionCount * 2} Minutes`;
            
            // Initialize question navigator
            initializeQuestionNavigator();
            
            // Load first question
            loadCurrentQuestion();
            
            // Start timer
            startTimer(questionCount * 120); // 2 minutes per question
        }

        function getRandomQuestions(questions, count) {
            // Create a pool of questions with proper randomization
            let questionPool = [];
            
            // Add all available questions to the pool
            if (Array.isArray(questions)) {
                questionPool = [...questions];
            } else {
                // Handle single question object (convert to array)
                questionPool = [questions];
            }
            
            // Add previously wrong questions with higher probability (adaptive learning)
            const relevantWrongQuestions = wrongAnsweredQuestions.filter(wrongQ => {
                return wrongQ.exam === selectedExam && 
                       wrongQ.subject === selectedSubject && 
                       wrongQ.chapter === selectedChapter;
            });
            
            // Add wrong questions multiple times to increase their selection probability
            relevantWrongQuestions.forEach(wrongQ => {
                // Add each wrong question 2 additional times for higher probability
                questionPool.push(wrongQ);
                questionPool.push(wrongQ);
            });
            
            // Shuffle the pool using Fisher-Yates algorithm for true randomization
            for (let i = questionPool.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [questionPool[i], questionPool[j]] = [questionPool[j], questionPool[i]];
            }
            
            // Remove duplicates while maintaining randomness
            const uniqueQuestions = [];
            const seenQuestions = new Set();
            
            for (const question of questionPool) {
                const questionKey = question.question;
                if (!seenQuestions.has(questionKey) && uniqueQuestions.length < count) {
                    uniqueQuestions.push(question);
                    seenQuestions.add(questionKey);
                }
            }
            
            // If we don't have enough unique questions, fill with random selections from original pool
            while (uniqueQuestions.length < count && questionPool.length > 0) {
                const randomIndex = Math.floor(Math.random() * questionPool.length);
                const randomQuestion = questionPool[randomIndex];
                const questionKey = randomQuestion.question;
                
                if (!seenQuestions.has(questionKey)) {
                    uniqueQuestions.push(randomQuestion);
                    seenQuestions.add(questionKey);
                }
                
                // Remove to avoid infinite loop
                questionPool.splice(randomIndex, 1);
            }
            
            return uniqueQuestions.slice(0, count);
        }

        function initializeQuestionNavigator() {
            const navigator = document.getElementById('questionNavigator');
            navigator.innerHTML = '';
            
            for (let i = 0; i < questionCount; i++) {
                const questionBtn = document.createElement('button');
                questionBtn.className = 'w-5 h-5 sm:w-6 sm:h-6 lg:w-8 lg:h-8 rounded text-xs lg:text-sm font-semibold transition-colors';
                questionBtn.textContent = i + 1;
                questionBtn.onclick = () => goToQuestion(i);
                navigator.appendChild(questionBtn);
            }
            
            updateQuestionNavigator();
        }

        function updateQuestionNavigator() {
            const navigator = document.getElementById('questionNavigator');
            const buttons = navigator.children;
            
            for (let i = 0; i < questionCount; i++) {
                const btn = buttons[i];
                btn.className = 'w-5 h-5 sm:w-6 sm:h-6 lg:w-8 lg:h-8 rounded text-xs lg:text-sm font-semibold transition-colors ';
                
                if (i === currentQuestionIndex) {
                    btn.className += 'bg-blue-500 text-white';
                } else if (markedQuestions[i]) {
                    btn.className += 'bg-yellow-500 text-white';
                } else if (userAnswers[i] !== '') {
                    btn.className += 'bg-green-500 text-white';
                } else {
                    btn.className += 'bg-gray-300 text-gray-700 hover:bg-gray-400';
                }
            }
        }

        function loadCurrentQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                submitTest('All questions completed');
                return;
            }
            
            currentQuestion = currentQuestions[currentQuestionIndex];
            
            // Update question number
            document.getElementById('questionNumber').textContent = `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
            document.getElementById('questionText').textContent = currentQuestion.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            currentQuestion.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                const isSelected = userAnswers[currentQuestionIndex] === option.charAt(0);
                optionDiv.innerHTML = `
                    <label class="flex items-start space-x-3 p-3 lg:p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                        <input type="radio" name="answer" value="${option.charAt(0)}" ${isSelected ? 'checked' : ''} class="text-primary mt-1 flex-shrink-0">
                        <span class="text-sm lg:text-base leading-relaxed">${option}</span>
                    </label>
                `;
                optionsContainer.appendChild(optionDiv);
            });
            
            // Add event listeners to radio buttons
            document.querySelectorAll('input[name="answer"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    userAnswers[currentQuestionIndex] = this.value;
                    updateQuestionNavigator();
                });
            });
            
            // Update navigation buttons
            updateNavigationButtons();
            updateQuestionNavigator();
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const markBtn = document.getElementById('markBtn');
            
            // Update Previous button
            prevBtn.disabled = currentQuestionIndex === 0;
            
            // Update Next button text
            if (currentQuestionIndex === currentQuestions.length - 1) {
                nextBtn.textContent = 'Last Question';
            } else {
                nextBtn.textContent = 'Next';
            }
            
            // Update Mark button text
            if (markedQuestions[currentQuestionIndex]) {
                markBtn.textContent = 'Unmark';
                markBtn.className = 'px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 font-semibold';
            } else {
                markBtn.textContent = 'Mark for Review';
                markBtn.className = 'px-6 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 font-semibold';
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                loadCurrentQuestion();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadCurrentQuestion();
            }
        }

        function markForReview() {
            markedQuestions[currentQuestionIndex] = !markedQuestions[currentQuestionIndex];
            updateNavigationButtons();
            updateQuestionNavigator();
        }

        function clearAnswer() {
            // Clear the selected answer
            userAnswers[currentQuestionIndex] = '';
            
            // Uncheck all radio buttons
            document.querySelectorAll('input[name="answer"]').forEach(radio => {
                radio.checked = false;
            });
            
            // Update the question navigator
            updateQuestionNavigator();
        }

        function goToQuestion(questionIndex) {
            if (questionIndex >= 0 && questionIndex < currentQuestions.length) {
                currentQuestionIndex = questionIndex;
                loadCurrentQuestion();
            }
        }

        function startTimer(seconds) {
            let timeLeft = seconds;
            const timerElement = document.getElementById('timer');
            
            testTimer = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const secs = timeLeft % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(testTimer);
                    submitTest();
                }
                timeLeft--;
            }, 1000);
        }

        function submitTest(reason = 'Manual submission') {
            clearInterval(testTimer);
            disableTestSecurity();
            
            // Calculate detailed results with new scoring system
            let correct = 0;
            let wrong = 0;
            let attempted = 0;
            let unattempted = 0;
            const questionResults = [];
            const newWrongQuestions = [];
            
            currentQuestions.forEach((question, index) => {
                const userAns = userAnswers[index] || '';
                const isCorrect = userAns === question.correct;
                const isAttempted = userAns !== '';
                
                if (isAttempted) {
                    attempted++;
                    if (isCorrect) {
                        correct++;
                    } else {
                        wrong++;
                        newWrongQuestions.push(question);
                    }
                } else {
                    unattempted++;
                }
                
                questionResults.push({
                    question: question.question,
                    options: question.options,
                    userAnswer: userAns,
                    correctAnswer: question.correct,
                    isCorrect: isCorrect,
                    isAttempted: isAttempted
                });
            });
            
            // Calculate marks using new scoring system
            const totalMarks = (correct * POSITIVE_MARKS) + (wrong * NEGATIVE_MARKS) + (unattempted * UNATTEMPTED_MARKS);
            const maxMarks = currentQuestions.length * POSITIVE_MARKS;
            
            // Update wrong questions for adaptive learning with better tracking
            newWrongQuestions.forEach(wrongQ => {
                const wrongQuestionWithContext = {
                    ...wrongQ,
                    exam: isPYQTest ? selectedPYQExam : selectedExam,
                    subject: isPYQTest ? wrongQ.subject : selectedSubject,
                    chapter: isPYQTest ? wrongQ.chapter : selectedChapter,
                    timestamp: Date.now(),
                    attempts: 1,
                    isPYQ: isPYQTest,
                    originalExam: isPYQTest ? selectedPYQExam : selectedExam
                };
                
                // Check if this question was already wrong before
                const existingIndex = wrongAnsweredQuestions.findIndex(existing => 
                    existing.question === wrongQ.question &&
                    existing.exam === wrongQuestionWithContext.exam &&
                    existing.subject === wrongQuestionWithContext.subject &&
                    existing.chapter === wrongQuestionWithContext.chapter
                );
                
                if (existingIndex !== -1) {
                    // Update existing wrong question with increased attempts
                    wrongAnsweredQuestions[existingIndex].attempts += 1;
                    wrongAnsweredQuestions[existingIndex].timestamp = Date.now();
                } else {
                    // Add new wrong question
                    wrongAnsweredQuestions.push(wrongQuestionWithContext);
                }
            });
            
            // Keep only last 200 wrong questions to prevent memory issues, prioritizing recent ones
            if (wrongAnsweredQuestions.length > 200) {
                wrongAnsweredQuestions.sort((a, b) => b.timestamp - a.timestamp);
                wrongAnsweredQuestions = wrongAnsweredQuestions.slice(0, 200);
            }
            
            const score = Math.round((correct / currentQuestions.length) * 100);
            const testDuration = Math.round((Date.now() - testStartTime) / 1000);
            
            // Add to test history with new scoring system
            const testResult = {
                exam: isPYQTest ? selectedPYQExam : selectedExam,
                subject: isPYQTest ? 'Mixed Subjects' : selectedSubject,
                chapter: isPYQTest ? 'Previous Year Questions' : selectedChapter,
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString(),
                score: score,
                attempted: attempted,
                correct: correct,
                wrong: wrong,
                unattempted: unattempted,
                totalQuestions: currentQuestions.length,
                totalMarks: totalMarks,
                maxMarks: maxMarks,
                positiveMarks: correct * POSITIVE_MARKS,
                negativeMarks: wrong * NEGATIVE_MARKS,
                duration: testDuration,
                reason: reason,
                questionResults: questionResults,
                isPYQTest: isPYQTest
            };
            
            testHistory.push(testResult);
            
            // Update statistics
            totalTests++;
            totalScore += score;
            if (score > bestScore) bestScore = score;
            
            // Save data
            saveData();
            
            // Update dashboard and history
            updateDashboard();
            updateTestHistory();
            
            // Show detailed result modal
            showResultModal(testResult);
        }

        function showResultModal(result) {
            const modal = document.getElementById('resultModal');
            const statsContainer = document.getElementById('resultStats');
            
            // Clear any existing content
            statsContainer.innerHTML = '';
            
            // Populate result stats with new scoring system
            statsContainer.innerHTML = `
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <p class="text-2xl font-bold text-blue-600">${result.totalMarks}/${result.maxMarks}</p>
                    <p class="text-sm text-blue-800">Total Marks</p>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <p class="text-2xl font-bold text-green-600">${result.correct}</p>
                    <p class="text-sm text-green-800">Correct (+${POSITIVE_MARKS})</p>
                </div>
                <div class="bg-red-50 p-4 rounded-lg text-center">
                    <p class="text-2xl font-bold text-red-600">${result.wrong}</p>
                    <p class="text-sm text-red-800">Wrong (${NEGATIVE_MARKS})</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg text-center">
                    <p class="text-2xl font-bold text-gray-600">${result.unattempted}</p>
                    <p class="text-sm text-gray-800">Unattempted (0)</p>
                </div>
                <div class="bg-yellow-50 p-4 rounded-lg text-center">
                    <p class="text-2xl font-bold text-yellow-600">${result.score}%</p>
                    <p class="text-sm text-yellow-800">Accuracy</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg text-center">
                    <p class="text-2xl font-bold text-purple-600">${Math.floor(result.duration / 60)}:${(result.duration % 60).toString().padStart(2, '0')}</p>
                    <p class="text-sm text-purple-800">Time Taken</p>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function closeResultModal() {
            // Re-enable sidebar and mobile nav buttons after test
document.querySelectorAll('.nav-btn, .nav-btn-mobile').forEach(btn => {
    btn.disabled = false;
    btn.classList.remove('opacity-50', 'pointer-events-none');
});

            document.getElementById('resultModal').classList.add('hidden');
            
            // Reset PYQ test mode and navigate appropriately
            if (isPYQTest) {
                isPYQTest = false;
                showSection('pyq');
            } else if (userManagementAccess) {
                showSection('userManagement');
            } else {
                showDashboard();
            }
        }

        // Generate explanation for questions
        function generateExplanation(question, correctAnswer, options) {
            const questionLower = question.toLowerCase();
            
            // Physics explanations
            if (questionLower.includes('velocity-time graph') && questionLower.includes('area')) {
                return `The area under a velocity-time graph represents the displacement of an object.<br><br>
                        Velocity is defined as displacement per unit time.<br><br>
                        So, if you multiply velocity (m/s) by time (s), you get:<br>
                        <strong>Velocity √ó Time = Displacement (m)</strong><br><br>
                        This is exactly what the area under a velocity-time graph tells you: the total displacement during that time interval.`;
            }
            
            if (questionLower.includes('mechanical waves') && questionLower.includes('require')) {
                return `Mechanical waves are waves that require a material medium to propagate.<br><br>
                        Examples include:<br>
                        ‚Ä¢ Sound waves (need air, water, or solid materials)<br>
                        ‚Ä¢ Water waves (need water as medium)<br>
                        ‚Ä¢ Seismic waves (need earth's crust)<br><br>
                        Unlike electromagnetic waves (light, radio waves), mechanical waves cannot travel through vacuum because they need particles of matter to transfer energy from one place to another.`;
            }
            
            if (questionLower.includes('newton') && questionLower.includes('first law')) {
                return `Newton's First Law states that an object at rest stays at rest, and an object in motion stays in motion at constant velocity, unless acted upon by an external force.<br><br>
                        This is also known as the <strong>Law of Inertia</strong> because it describes the tendency of objects to resist changes in their state of motion.<br><br>
                        Inertia is the property of matter that causes it to resist acceleration.`;
            }
            
            if (questionLower.includes('si unit') && questionLower.includes('force')) {
                return `The SI unit of force is the Newton (N).<br><br>
                        It is named after Sir Isaac Newton and is defined as:<br>
                        <strong>1 Newton = 1 kg‚ãÖm/s¬≤</strong><br><br>
                        This means one Newton is the force required to accelerate a mass of 1 kilogram at a rate of 1 meter per second squared.`;
            }
            
            if (questionLower.includes('acceleration due to gravity')) {
                return `The acceleration due to gravity on Earth is approximately <strong>9.8 m/s¬≤</strong>.<br><br>
                        This value:<br>
                        ‚Ä¢ Is constant near Earth's surface<br>
                        ‚Ä¢ Acts downward toward Earth's center<br>
                        ‚Ä¢ Varies slightly with altitude and latitude<br>
                        ‚Ä¢ Is often approximated as 10 m/s¬≤ for quick calculations`;
            }
            
            // Chemistry explanations
            if (questionLower.includes('alkanes') && questionLower.includes('general formula')) {
                return `Alkanes are saturated hydrocarbons with the general formula <strong>C‚ÇôH‚ÇÇ‚Çô‚Çä‚ÇÇ</strong>.<br><br>
                        Examples:<br>
                        ‚Ä¢ Methane: CH‚ÇÑ (n=1, so 2(1)+2 = 4 hydrogens)<br>
                        ‚Ä¢ Ethane: C‚ÇÇH‚ÇÜ (n=2, so 2(2)+2 = 6 hydrogens)<br>
                        ‚Ä¢ Propane: C‚ÇÉH‚Çà (n=3, so 2(3)+2 = 8 hydrogens)<br><br>
                        They are called saturated because they contain only single bonds between carbon atoms.`;
            }
            
            if (questionLower.includes('avogadro') && questionLower.includes('number')) {
                return `Avogadro's number is approximately <strong>6.02 √ó 10¬≤¬≥</strong>.<br><br>
                        This represents:<br>
                        ‚Ä¢ The number of atoms in 12 grams of carbon-12<br>
                        ‚Ä¢ The number of particles in one mole of any substance<br>
                        ‚Ä¢ A fundamental constant in chemistry<br><br>
                        It's used to convert between the atomic scale and the macroscopic scale.`;
            }
            
            // Mathematics explanations
            if (questionLower.includes('derivative') && questionLower.includes('x¬≤')) {
                return `The derivative of x¬≤ is <strong>2x</strong>.<br><br>
                        Using the power rule: d/dx(x‚Åø) = n‚ãÖx‚Åø‚Åª¬π<br><br>
                        For x¬≤:<br>
                        ‚Ä¢ n = 2<br>
                        ‚Ä¢ So d/dx(x¬≤) = 2‚ãÖx¬≤‚Åª¬π = 2‚ãÖx¬π = 2x<br><br>
                        This means the rate of change of x¬≤ at any point x is 2x.`;
            }
            
            if (questionLower.includes('sin¬≤Œ∏') && questionLower.includes('cos¬≤Œ∏')) {
                return `The fundamental trigonometric identity states that <strong>sin¬≤Œ∏ + cos¬≤Œ∏ = 1</strong>.<br><br>
                        This identity:<br>
                        ‚Ä¢ Is true for all values of Œ∏<br>
                        ‚Ä¢ Comes from the Pythagorean theorem applied to the unit circle<br>
                        ‚Ä¢ Is one of the most important identities in trigonometry<br><br>
                        It can be used to derive many other trigonometric identities.`;
            }
            
            // Biology explanations
            if (questionLower.includes('basic unit of life')) {
                return `The cell is the basic unit of life.<br><br>
                        Key points about cells:<br>
                        ‚Ä¢ All living organisms are made of one or more cells<br>
                        ‚Ä¢ Cells are the smallest units that can carry out all life processes<br>
                        ‚Ä¢ They can exist as single-celled organisms or as part of multicellular organisms<br><br>
                        This is a fundamental principle of cell theory.`;
            }
            
            if (questionLower.includes('genes') && questionLower.includes('made up')) {
                return `Genes are made up of <strong>DNA (Deoxyribonucleic Acid)</strong>.<br><br>
                        DNA:<br>
                        ‚Ä¢ Contains the genetic instructions for all living organisms<br>
                        ‚Ä¢ Is composed of four nucleotide bases: A, T, G, C<br>
                        ‚Ä¢ Forms a double helix structure<br>
                        ‚Ä¢ Stores hereditary information that is passed from parents to offspring`;
            }
            
            // Default explanation for unrecognized questions
            const correctOption = options ? options.find(opt => opt.startsWith(correctAnswer)) : correctAnswer;
            return `The correct answer is <strong>${correctOption}</strong>.<br><br>
                    This is a fundamental concept in ${selectedSubject}. Understanding this topic is important for mastering the subject.<br><br>
                    Review your study materials for more detailed information about this concept.`;
        }

        // Download analysis PDF function
        function downloadAnalysisPDF() {
            // Get the last test result
            const lastTest = testHistory[testHistory.length - 1];
            if (!lastTest) return;
            
            // Create PDF content as HTML with professional styling
            const pdfContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>ExamAce Test Analysis Report</title>
                    <meta charset="UTF-8">
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { 
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                            line-height: 1.6; 
                            color: #333; 
                            max-width: 800px; 
                            margin: 0 auto; 
                            padding: 20px;
                            background: #f8f9fa;
                            position: relative;
                        }
                        
                        /* MPULE TEST Watermark */
                        body::before {
                            content: "MPULE TEST";
                            position: fixed;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%) rotate(-45deg);
                            font-size: 120px;
                            font-weight: bold;
                            color: rgba(0, 0, 0, 0.05);
                            z-index: -1;
                            pointer-events: none;
                            white-space: nowrap;
                        }
                        
                        @media print {
                            body::before {
                                position: absolute;
                                color: rgba(0, 0, 0, 0.08);
                            }
                        }
                        .container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
                        .header { 
                            text-align: center; 
                            margin-bottom: 40px; 
                            padding-bottom: 20px; 
                            border-bottom: 3px solid #3b82f6;
                        }
                        .header h1 { 
                            color: #1e40af; 
                            font-size: 28px; 
                            margin-bottom: 10px; 
                            font-weight: 700;
                        }
                        .header h2 { 
                            color: #374151; 
                            font-size: 20px; 
                            margin-bottom: 10px; 
                            font-weight: 600;
                        }
                        .header p { color: #6b7280; font-size: 14px; }
                        
                        .stats { 
                            display: grid; 
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
                            gap: 20px; 
                            margin-bottom: 40px; 
                        }
                        .stat-box { 
                            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
                            border: 2px solid #d1d5db; 
                            padding: 20px; 
                            text-align: center; 
                            border-radius: 10px;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                        }
                        .stat-box h3 { color: #374151; font-size: 14px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
                        .stat-box h2 { color: #1f2937; font-size: 24px; font-weight: 700; }
                        
                        .section-title { 
                            color: #1e40af; 
                            font-size: 22px; 
                            margin: 30px 0 20px 0; 
                            padding-bottom: 10px; 
                            border-bottom: 2px solid #e5e7eb;
                            font-weight: 600;
                        }
                        
                        .question { 
                            margin-bottom: 25px; 
                            padding: 20px; 
                            border-radius: 8px; 
                            border-left: 5px solid;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        }
                        .correct { 
                            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); 
                            border-left-color: #10b981; 
                        }
                        .wrong { 
                            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%); 
                            border-left-color: #ef4444; 
                        }
                        .unattempted { 
                            background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%); 
                            border-left-color: #6b7280; 
                        }
                        
                        .question-header { 
                            font-size: 16px; 
                            font-weight: 600; 
                            margin-bottom: 15px; 
                            display: flex; 
                            align-items: center; 
                        }
                        .correct .question-header { color: #065f46; }
                        .wrong .question-header { color: #991b1b; }
                        .unattempted .question-header { color: #374151; }
                        
                        .question-text { 
                            font-size: 15px; 
                            margin-bottom: 15px; 
                            color: #1f2937; 
                            font-weight: 500;
                            line-height: 1.7;
                        }
                        
                        .answer-section { 
                            display: grid; 
                            gap: 8px; 
                            font-size: 14px; 
                        }
                        .answer-row { 
                            display: flex; 
                            align-items: center; 
                        }
                        .answer-label { 
                            font-weight: 600; 
                            min-width: 120px; 
                            color: #374151; 
                        }
                        .answer-value { 
                            color: #1f2937; 
                            font-weight: 500;
                        }
                        .correct-answer { color: #059669 !important; font-weight: 600; }
                        .wrong-answer { color: #dc2626 !important; font-weight: 600; }
                        .no-answer { color: #6b7280 !important; font-style: italic; }
                        
                        .status-badge { 
                            padding: 4px 12px; 
                            border-radius: 20px; 
                            font-size: 12px; 
                            font-weight: 600; 
                            text-transform: uppercase; 
                            letter-spacing: 0.5px;
                            margin-left: 10px;
                        }
                        .correct .status-badge { background: #10b981; color: white; }
                        .wrong .status-badge { background: #ef4444; color: white; }
                        .unattempted .status-badge { background: #6b7280; color: white; }
                        
                        .footer { 
                            margin-top: 40px; 
                            padding-top: 20px; 
                            border-top: 2px solid #e5e7eb; 
                            text-align: center; 
                            color: #6b7280; 
                            font-size: 12px; 
                        }
                        .footer strong { color: #374151; }
                        
                        @media print {
                            body { background: white; }
                            .container { box-shadow: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <div class="header">
                            <h1>üìä ExamAce Test Analysis Report</h1>
                            <h2>${lastTest.exam} ‚Ä¢ ${lastTest.subject} ‚Ä¢ ${lastTest.chapter}</h2>
                            <p>Test Date: ${lastTest.date} ‚Ä¢ Time: ${lastTest.time} ‚Ä¢ Duration: ${Math.floor((lastTest.duration || 0) / 60)}:${((lastTest.duration || 0) % 60).toString().padStart(2, '0')}</p>
                        </div>
                        
                        <div class="stats">
                            <div class="stat-box">
                                <h3>Overall Score</h3>
                                <h2 style="color: ${lastTest.score >= 80 ? '#059669' : lastTest.score >= 60 ? '#d97706' : '#dc2626'};">${lastTest.score}%</h2>
                            </div>
                            <div class="stat-box">
                                <h3>Questions Attempted</h3>
                                <h2>${lastTest.attempted}/${lastTest.totalQuestions}</h2>
                            </div>
                            <div class="stat-box">
                                <h3>Accuracy Rate</h3>
                                <h2>${lastTest.attempted > 0 ? Math.round((lastTest.correct / lastTest.attempted) * 100) : 0}%</h2>
                            </div>
                            <div class="stat-box">
                                <h3>Performance</h3>
                                <h2 style="color: ${lastTest.score >= 80 ? '#059669' : lastTest.score >= 60 ? '#d97706' : '#dc2626'};">${lastTest.score >= 80 ? 'Excellent' : lastTest.score >= 60 ? 'Good' : 'Needs Work'}</h2>
                            </div>
                        </div>
                        
                        <h3 class="section-title">üìù Detailed Question Analysis</h3>
                        ${lastTest.questionResults ? lastTest.questionResults.map((q, index) => {
                            const optionLetter = q.userAnswer || 'Not attempted';
                            const correctLetter = q.correctAnswer;
                            const userOption = q.options ? q.options.find(opt => opt.startsWith(optionLetter)) : optionLetter;
                            const correctOption = q.options ? q.options.find(opt => opt.startsWith(correctLetter)) : correctLetter;
                            
                            // Use the explanation from the question object, or generate one if not available
                            const explanation = q.explanation || generateExplanation(q.question, correctLetter, q.options);
                            
                            return `
                                <div class="question ${q.isCorrect ? 'correct' : q.isAttempted ? 'wrong' : 'unattempted'}">
                                    <div class="question-header">
                                        <strong>Q${index + 1}:</strong> ${q.question}
                                    </div>
                                    
                                    <div class="options-section" style="margin: 15px 0;">
                                        <strong>Options:</strong><br>
                                        ${q.options ? q.options.map(opt => `&nbsp;&nbsp;${opt}`).join('<br>') : 'No options available'}
                                    </div>
                                    
                                    <div class="answer-section">
                                        <div class="answer-row">
                                            <span class="answer-label"><strong>Your Answer:</strong></span>
                                            <span class="answer-value ${q.isCorrect ? 'correct-answer' : q.isAttempted ? 'wrong-answer' : 'no-answer'}">
                                                ${userOption || 'Not attempted'}
                                            </span>
                                        </div>
                                        <div class="answer-row">
                                            <span class="answer-label"><strong>Correct Answer:</strong></span>
                                            <span class="answer-value correct-answer">
                                                ${correctOption}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="explanation-section" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                        <strong>Explanation:</strong><br>
                                        ${explanation}
                                    </div>
                                </div>
                            `;
                        }).join('') : '<p style="text-align: center; color: #6b7280; padding: 40px;">No detailed analysis available</p>'}
                        
                        <div class="footer">
                            <p><strong>Generated by ExamAce</strong> - Your Competitive Exam Preparation Platform</p>
                            <p>Report generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                            <p style="margin-top: 10px; font-size: 11px;">For support: mpulseinstitutions@gmail.com</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Create and download the PDF as HTML file
            const blob = new Blob([pdfContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `ExamAce_Analysis_${lastTest.exam}_${lastTest.subject}_${lastTest.chapter}_${lastTest.date.replace(/\//g, '-')}.html`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('üìÑ Professional Analysis Report Downloaded!\n\n‚úÖ Features included:\n‚Ä¢ Detailed question-by-question analysis\n‚Ä¢ Professional formatting with color coding\n‚Ä¢ Complete answer explanations\n‚Ä¢ Performance statistics\n‚Ä¢ Print-ready layout\n\nOpen the HTML file in any browser to view or print as PDF.');
        }

        function showDashboard() {
            document.getElementById('testInterface').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            
            // Reset navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('text-gray-700', 'hover:bg-gray-100');
            });
            document.querySelector('.nav-btn').classList.add('bg-primary', 'text-white');
            document.querySelector('.nav-btn').classList.remove('text-gray-700', 'hover:bg-gray-100');
        }

        function updateDashboard() {
            document.getElementById('testsCompleted').textContent = totalTests;
            document.getElementById('avgAccuracy').textContent = totalTests > 0 ? Math.round(totalScore / totalTests) + '%' : '0%';
            document.getElementById('bestScore').textContent = bestScore + '%';
            
            // Update recent activity
            const recentActivity = document.getElementById('recentActivity');
            if (testHistory.length > 0) {
                const recent = testHistory.slice(-3).reverse();
                recentActivity.innerHTML = recent.map(test => `
                    <div class="flex items-center justify-between p-4 border rounded-lg">
                        <div>
                            <p class="font-semibold">${test.exam} - ${test.subject}</p>
                            <p class="text-sm text-gray-600">${test.chapter} ‚Ä¢ ${test.date}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold ${test.score >= 80 ? 'text-green-600' : test.score >= 60 ? 'text-yellow-600' : 'text-red-600'}">${test.score}%</p>
                            <p class="text-sm text-gray-500">${test.score >= 80 ? 'Excellent' : test.score >= 60 ? 'Good' : 'Needs Work'}</p>
                        </div>
                    </div>
                `).join('');
            }
            
            // Update chapter-wise accuracy
            updateChapterAccuracy();
        }

        function updateChapterAccuracy() {
            const chapterContainer = document.getElementById('chapterAccuracy');
            
            if (testHistory.length === 0) {
                chapterContainer.innerHTML = `
                    <div class="text-center text-gray-400 py-8">
                        <p>No chapter data available. Complete tests to see your performance by chapter!</p>
                    </div>
                `;
                return;
            }
            
            // Group tests by exam, subject, and chapter
            const chapterStats = {};
            
            testHistory.forEach(test => {
                const key = `${test.exam}-${test.subject}-${test.chapter}`;
                if (!chapterStats[key]) {
                    chapterStats[key] = {
                        exam: test.exam,
                        subject: test.subject,
                        chapter: test.chapter,
                        scores: [],
                        totalTests: 0
                    };
                }
                chapterStats[key].scores.push(test.score);
                chapterStats[key].totalTests++;
            });
            
            // Calculate averages and sort by performance
            const chapterData = Object.values(chapterStats).map(chapter => {
                const avgScore = Math.round(chapter.scores.reduce((a, b) => a + b, 0) / chapter.scores.length);
                const bestScore = Math.max(...chapter.scores);
                return {
                    ...chapter,
                    avgScore,
                    bestScore
                };
            }).sort((a, b) => b.avgScore - a.avgScore);
            
            // Display chapter performance
            chapterContainer.innerHTML = chapterData.map(chapter => {
                const progressColor = chapter.avgScore >= 80 ? 'bg-green-500' : 
                                    chapter.avgScore >= 60 ? 'bg-yellow-500' : 'bg-red-500';
                const textColor = chapter.avgScore >= 80 ? 'text-green-700' : 
                                chapter.avgScore >= 60 ? 'text-yellow-700' : 'text-red-700';
                const bgColor = chapter.avgScore >= 80 ? 'bg-green-50' : 
                              chapter.avgScore >= 60 ? 'bg-yellow-50' : 'bg-red-50';
                
                return `
                    <div class="border rounded-lg p-4 ${bgColor}">
                        <div class="flex justify-between items-start mb-3">
                            <div>
                                <h4 class="font-semibold text-gray-800">${chapter.exam} - ${chapter.subject}</h4>
                                <p class="text-sm text-gray-600">${chapter.chapter}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold ${textColor}">${chapter.avgScore}%</p>
                                <p class="text-xs text-gray-500">Avg Score</p>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="flex justify-between text-sm text-gray-600 mb-1">
                                <span>Progress</span>
                                <span>${chapter.avgScore}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="${progressColor} h-2 rounded-full transition-all duration-300" style="width: ${chapter.avgScore}%"></div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between text-xs text-gray-600">
                            <span>Best: ${chapter.bestScore}%</span>
                            <span>Tests: ${chapter.totalTests}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateTestHistory() {
            const tableBody = document.getElementById('testHistoryTable');
            const historyInfo = document.getElementById('historyInfo');
            const paginationControls = document.getElementById('paginationControls');
            
            // Get filtered test history
            const filteredHistory = getFilteredTestHistory();
            
            if (filteredHistory.length === 0) {
                const message = testHistory.length === 0 ? 
                    'No tests completed yet. Start taking tests to see your history!' :
                    'No tests match the selected filters. Try adjusting your filter criteria.';
                    
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="8" class="text-center py-8 text-gray-500">
                            ${message}
                        </td>
                    </tr>
                `;
                historyInfo.textContent = `Showing 0 of ${testHistory.length} tests`;
                paginationControls.classList.add('hidden');
                return;
            }
            
            // Calculate pagination for filtered results
            const totalTests = filteredHistory.length;
            const totalPages = Math.ceil(totalTests / testsPerPage);
            const startIndex = (currentPage - 1) * testsPerPage;
            const endIndex = Math.min(startIndex + testsPerPage, totalTests);
            
            // Get tests for current page (reverse order - newest first)
            const reversedHistory = [...filteredHistory].reverse();
            const currentPageTests = reversedHistory.slice(startIndex, endIndex);
            
            // Update table with new scoring system
            tableBody.innerHTML = currentPageTests.map((test, index) => {
                // Calculate marks for older tests that might not have the new scoring
                const totalMarks = test.totalMarks !== undefined ? test.totalMarks : 
                    (test.correct * POSITIVE_MARKS) + (test.wrong * NEGATIVE_MARKS);
                const maxMarks = test.maxMarks !== undefined ? test.maxMarks : 
                    (test.totalQuestions * POSITIVE_MARKS);
                
                return `
                    <tr class="border-b hover:bg-gray-50">
                        <td class="py-3 px-4">
                            <div>
                                <p class="font-semibold">${test.exam} - ${test.subject}</p>
                                <p class="text-sm text-gray-600">${test.chapter}</p>
                                <p class="text-xs text-gray-400">Test #${totalTests - startIndex - index}</p>
                            </div>
                        </td>
                        <td class="py-3 px-4">
                            <div>
                                <p class="text-sm">${test.date}</p>
                                <p class="text-xs text-gray-500">${test.time}</p>
                            </div>
                        </td>
                        <td class="py-3 px-4">
                            <div>
                                <span class="font-bold text-lg ${totalMarks >= 0 ? 'text-green-600' : 'text-red-600'}">${totalMarks}/${maxMarks}</span>
                                <p class="text-xs text-gray-500">Marks</p>
                            </div>
                        </td>
                        <td class="py-3 px-4">
                            <span class="font-bold text-lg ${test.score >= 80 ? 'text-green-600' : test.score >= 60 ? 'text-yellow-600' : 'text-red-600'}">${test.score}%</span>
                        </td>
                        <td class="py-3 px-4">
                            <span class="px-2 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800">${test.attempted}/${test.totalQuestions}</span>
                        </td>
                        <td class="py-3 px-4">
                            <span class="px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">${test.correct} (+${POSITIVE_MARKS})</span>
                        </td>
                        <td class="py-3 px-4">
                            <span class="px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800">${test.wrong} (${NEGATIVE_MARKS})</span>
                        </td>
                        <td class="py-3 px-4">
                            <span class="px-3 py-1 rounded-full text-xs font-semibold ${test.score >= 80 ? 'bg-green-100 text-green-800' : test.score >= 60 ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}">
                                ${test.score >= 80 ? '‚úì Excellent' : test.score >= 60 ? '~ Good' : '‚úó Needs Work'}
                            </span>
                        </td>
                    </tr>
                `;
            }).join('');
            
            // Update info and pagination with filter information
            const filterInfo = testHistory.length !== totalTests ? 
                ` (filtered from ${testHistory.length} total)` : '';
            historyInfo.textContent = `Showing ${startIndex + 1}-${endIndex} of ${totalTests} tests${filterInfo}`;
            
            if (totalPages > 1) {
                paginationControls.classList.remove('hidden');
                updatePaginationControls(currentPage, totalPages);
            } else {
                paginationControls.classList.add('hidden');
            }
            
            // Update filter buttons
            updateFilterButtons();
        }
        
        function updatePaginationControls(page, totalPages) {
            const prevBtn = document.getElementById('prevPageBtn');
            const nextBtn = document.getElementById('nextPageBtn');
            const pageInfo = document.getElementById('pageInfo');
            
            // Update buttons
            prevBtn.disabled = page <= 1;
            nextBtn.disabled = page >= totalPages;
            
            // Update page info
            pageInfo.textContent = `Page ${page} of ${totalPages}`;
            
            // Update button styles
            if (prevBtn.disabled) {
                prevBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                prevBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
            
            if (nextBtn.disabled) {
                nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }
        
        function changePage(direction) {
            const filteredHistory = getFilteredTestHistory();
            const totalPages = Math.ceil(filteredHistory.length / testsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                updateTestHistory();
            }
        }

        // Show reset confirmation modal
        function showResetModal() {
            document.getElementById('resetModal').classList.remove('hidden');
        }

        // Close reset modal
        function closeResetModal() {
            document.getElementById('resetModal').classList.add('hidden');
        }

        // Confirm reset - delete all data
        function confirmReset() {
            if (currentUser) {
                // Clear current user's data
                localStorage.removeItem(`examAceData_${currentUser}`);
                
                // Reset current session variables
                testHistory = [];
                totalTests = 0;
                totalScore = 0;
                bestScore = 0;
                wrongAnsweredQuestions = [];
                downloadedQuestions = {};
                availablePDFs = {};
                
                // Update displays
                updateDashboard();
                updateTestHistory();
                
                // Close modal
                closeResetModal();
                
                // Show success message
                alert('‚úÖ All data has been reset successfully!\n\nYour dashboard, test history, and PDF download history have been cleared.');
            }
        }

        // Save user-specific data to localStorage
        function saveUserData() {
            if (currentUser) {
                const userData = {
                    testHistory: testHistory,
                    totalTests: totalTests,
                    totalScore: totalScore,
                    bestScore: bestScore,
                    wrongAnsweredQuestions: wrongAnsweredQuestions,
                    currentPage: currentPage,
                    activeFilters: activeFilters, // Save active filters
                    downloadedQuestions: downloadedQuestions, // Save PDF download tracking
                    availablePDFs: availablePDFs // Save available PDFs tracking
                };
                localStorage.setItem(`examAceData_${currentUser}`, JSON.stringify(userData));
            }
        }

        // Save global data to localStorage
        function saveData() {
            // Save current user's data (only for students)
            if (currentUser && userAccounts[currentUser]) {
                saveUserData();
            }
            
            // Save global state
            const globalData = {
                currentUser: currentUser,
                userManagementAccess: userManagementAccess,
                isDarkMode: isDarkMode
            };
            localStorage.setItem('examAceGlobal', JSON.stringify(globalData));
        }

        // Load data from localStorage
        function loadData() {
            // Load saved user accounts first
            const savedUserAccounts = localStorage.getItem('examAceUserAccounts');
            if (savedUserAccounts) {
                const savedAccounts = JSON.parse(savedUserAccounts);
                // Merge saved accounts with default accounts
                Object.assign(userAccounts, savedAccounts);
            }
            
            // Load global state
            const globalData = localStorage.getItem('examAceGlobal');
            if (globalData) {
                const data = JSON.parse(globalData);
                currentUser = data.currentUser || '';
                userManagementAccess = data.userManagementAccess || false;
                isDarkMode = data.isDarkMode !== undefined ? data.isDarkMode : true;
                
                // Apply saved theme
                const html = document.documentElement;
                const toggleSlider = document.getElementById('toggleSlider');
                
                if (isDarkMode) {
                    html.classList.add('dark');
                    if (toggleSlider) {
                        toggleSlider.classList.remove('translate-x-1');
                        toggleSlider.classList.add('translate-x-6');
                    }
                } else {
                    html.classList.remove('dark');
                    if (toggleSlider) {
                        toggleSlider.classList.remove('translate-x-6');
                        toggleSlider.classList.add('translate-x-1');
                    }
                }
                
                // If student was logged in, restore session
                if (currentUser && userAccounts[currentUser]) {
                    document.getElementById('loginPage').style.display = 'none';
                    updateUserProfile();
                    loadUserData();
                    updateDashboard();
                    document.getElementById('userManagementNav').classList.add('hidden');
                }
                // If manager was logged in, restore session
                else if (currentUser && managementAccounts[currentUser]) {
                    document.getElementById('loginPage').style.display = 'none';
                    updateManagementProfile();
                    document.getElementById('userManagementNav').classList.remove('hidden');
                    showSection('userManagement');
                }
                

            }
        }



        // Dark mode toggle function
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            const html = document.documentElement;
            const toggleSlider = document.getElementById('toggleSlider');
            
            if (isDarkMode) {
                // Switch to dark mode
                html.classList.add('dark');
                toggleSlider.classList.remove('translate-x-1');
                toggleSlider.classList.add('translate-x-6');
            } else {
                // Switch to light mode
                html.classList.remove('dark');
                toggleSlider.classList.remove('translate-x-6');
                toggleSlider.classList.add('translate-x-1');
            }
            
            saveData();
        }
        
        // Update theme colors for all elements
        function updateThemeColors() {
            const sections = document.querySelectorAll('.section');
            const cards = document.querySelectorAll('.bg-gradient-to-br');
            const navButtons = document.querySelectorAll('.nav-btn');
            
            sections.forEach(section => {
                if (isDarkMode) {
                    section.style.color = 'white';
                } else {
                    section.style.color = 'black';
                }
            });
            
            // Update navigation buttons
            navButtons.forEach(btn => {
                if (isDarkMode) {
                    if (!btn.classList.contains('bg-gradient-to-r')) {
                        btn.classList.remove('text-gray-700', 'hover:bg-gray-100');
                        btn.classList.add('text-gray-300', 'hover:bg-slate-700', 'hover:text-white');
                    }
                } else {
                    if (!btn.classList.contains('bg-gradient-to-r')) {
                        btn.classList.remove('text-gray-300', 'hover:bg-slate-700', 'hover:text-white');
                        btn.classList.add('text-gray-700', 'hover:bg-gray-100');
                    }
                }
            });
        }

        // Handle window close/refresh - save data
        window.addEventListener('beforeunload', function() {
            saveData();
        });

        // Initialize dashboard on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadData(); // Load saved data first
            updateDashboard();
            updatePDFCounts(); // Update PDF counts
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'963002ec31cba8b0',t:'MTc1MzE1NjYyMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
